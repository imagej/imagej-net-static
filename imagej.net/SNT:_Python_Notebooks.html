<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>SNT: Scripting - ImageJ</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"SNT:_Scripting","wgTitle":"SNT: Scripting","wgCurRevisionId":45678,"wgRevisionId":45678,"wgArticleId":10830,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["SNT","Neuroanatomy","Scripting"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"SNT:_Scripting","wgRelevantArticleId":10830,"wgRequestId":"39f222f0fe9df49c42393d25","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgPreferredVariant":"en","fancytree_path":"/extensions/TreeAndMenu/fancytree"});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user.cssprefs":"ready","user":"ready","user.options":"loading","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","skins.erudite":"ready"});mw.loader.implement("user.options@0j3lz3q",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens@1ku9xth",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.page.startup"]);});</script>
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%252Cshared%257Cmediawiki.sectionAnchor%257Cskins.erudite&amp;only=styles&amp;skin=erudite.css"/>
<script async="" src="load.php%3Fdebug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=erudite"></script>
<link rel="stylesheet" href="extensions/TreeAndMenu/fancytree/fancytree.css"/><link rel="stylesheet" href="extensions/TreeAndMenu/suckerfish/suckerfish.css"/>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=erudite.css"/>
<meta name="generator" content="MediaWiki 1.28.0"/>
<meta name="description" content="The most up-to-date SNT API can be found at https://morphonets.github.io/SNT."/>
<link rel="shortcut icon" href="skins/ij2.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="ImageJ (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="api.php?action=rsd"/>
<link rel="alternate" type="application/atom+xml" title="ImageJ Atom feed" href="index.php?title=Special:RecentChanges&amp;feed=atom"/>

<script type="text/javascript" src="extensions/SyntaxHighlighter/syntaxhighlighter/scripts/shCore.js"></script>
<script type="text/javascript" src="extensions/SyntaxHighlighter/syntaxhighlighter/scripts/shBrushPython.js"></script>
<script type="text/javascript">
SyntaxHighlighter.all();
</script>
<link rel="stylesheet" type="text/css" media="screen" href="extensions/SyntaxHighlighter/syntaxhighlighter/styles/shCoreMinit.css" />

	<meta property="og:type" content="article"/>

	<meta property="og:site_name" content="ImageJ"/>

	<meta property="og:title" content="SNT: Scripting"/>

	<meta property="og:description" content="The most up-to-date SNT API can be found at https://morphonets.github.io/SNT."/>

	<meta property="og:url" content="http://imagej.net/SNT:_Scripting"/>

<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-SNT_Scripting rootpage-SNT_Scripting skin-erudite action-view">
		<div class="mw-jump">
			<a href="./SNT:_Python_Notebooks.html#bodyContent">Skip to content</a>, 			<a href="./SNT:_Python_Notebooks.html#search">Skip to search</a>
		</div>

		<div id="top-wrap" role="banner">
			<h1><a href="Welcome" title="ImageJ" rel="home">ImageJ</a></h1>
			<div id="tagline">From ImageJ</div>

			<a id="menubutton" href="./SNT:_Python_Notebooks.html#menu">Menu</a>
			<div id="nav" role="navigation">
			<ul id='menu'>
<li id="menu-item-n-About"><a href="ImageJ">About</a></li>
<li id="menu-item-n-Downloads"><a href="Downloads">Downloads</a></li>
<li id="menu-item-n-Learn"><a href="Learn">Learn</a></li>
<li id="menu-item-n-Develop"><a href="Development">Develop</a></li>
<li id="menu-item-n-News"><a href="News">News</a></li>
<li id="menu-item-n-Events"><a href="Events">Events</a></li>
<li id="menu-item-n-Help"><a href="Help">Help</a></li>
</ul>
			</div>
		</div>

		<div id="mw-js-message"></div>
		
		<div id="main" role="main">
			<div id="nav-meta">
			<span id="ca-nstab-main" class="selected"><a href="./SNT:_Python_Notebooks.html" title="View the content page [c]" accesskey="c">Page</a></span><span class="meta-sep">|</span><span id="ca-talk" class="new"><a href="index.php?title=Talk:SNT:_Scripting&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></span><span class="meta-sep">|</span><span id="ca-viewsource"><a href="index.php?title=SNT:_Scripting&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span><span class="meta-sep">|</span><span id="ca-history"><a href="index.php?title=SNT:_Scripting&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></span><span class="meta-sep">|</span>			</div>

			<div id="bodyContent">
				<h1>SNT: Scripting</h1>
				
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="project-info">
<span class="project-logo"><a href="SNT" title="SNT"><img class="simple-tooltip simple-tooltip-img" data-simple-tooltip="This page describes content which is part of SNT. Click the logo for details." src="_images/5/5d/SNTLogo512.png"></img></a></span></div>
<table style="width:100%; background:#F6F9ED; border:1px solid #AAA; border-collapse:collapse; clear:both; font-size:85%;">
<tr>
<td style="background:#EEF3E2"><b><a href="SNT" title="SNT">Home</a></b>
</td>
<td style="text-align:center;"> <a href="SNT:_Manual" title="SNT: Manual">Manual</a>
</td>
<td style="text-align:center;"> <a href="SNT:_Step-By-Step_Instructions" title="SNT: Step-By-Step Instructions">Walk-throughs</a>
</td>
<td style="text-align:center;"> <a href="SNT:_Screencasts" title="SNT: Screencasts">Screencasts</a>
</td>
<td style="text-align:center;"> <a href="SNT:_Key_Shortcuts" title="SNT: Key Shortcuts">Shortcuts</a>
</td>
<td style="text-align:center;"> <a href="SNT:_Reconstruction_Viewer" title="SNT: Reconstruction Viewer">Rec. Viewer</a>
</td>
<td style="text-align:center;"> <a href="SNT:_Analysis" title="SNT: Analysis">Analysis</a>
</td>
<td style="text-align:center;"> <strong class="selflink">Scripting</strong>
</td>
<td style="text-align:center;"> <a href="SNT:_Modeling" title="SNT: Modeling">Modeling</a>
</td>
<td style="text-align:center;"> <a href="SNT:_FAQ" title="SNT: FAQ">FAQ</a>
</td></tr></table>
<div style="clear:both;"></div>
<p><br />
</p><p><br />
</p>
<div class="toclimit-3">
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="./SNT:_Python_Notebooks.html#SNT_API"><span class="tocnumber">1</span> <span class="toctext">SNT API</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="./SNT:_Python_Notebooks.html#Script_Templates"><span class="tocnumber">2</span> <span class="toctext">Script Templates</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="./SNT:_Python_Notebooks.html#Analysis"><span class="tocnumber">2.1</span> <span class="toctext">Analysis</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="./SNT:_Python_Notebooks.html#Boilerplate"><span class="tocnumber">2.2</span> <span class="toctext">Boilerplate</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="./SNT:_Python_Notebooks.html#Tracing"><span class="tocnumber">2.3</span> <span class="toctext">Tracing</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="./SNT:_Python_Notebooks.html#Batch"><span class="tocnumber">2.4</span> <span class="toctext">Batch</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="./SNT:_Python_Notebooks.html#Python_Notebooks"><span class="tocnumber">3</span> <span class="toctext">Python Notebooks</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="./SNT:_Python_Notebooks.html#Adding_Scripts_to_SNT"><span class="tocnumber">4</span> <span class="toctext">Adding Scripts to SNT</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="./SNT:_Python_Notebooks.html#Examples"><span class="tocnumber">5</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="./SNT:_Python_Notebooks.html#Scripting_Reconstruction_Viewer"><span class="tocnumber">5.1</span> <span class="toctext">Scripting Reconstruction Viewer</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="./SNT:_Python_Notebooks.html#Script_Interpreter"><span class="tocnumber">5.2</span> <span class="toctext">Script Interpreter</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="SNT_API">SNT API</span></h2>
<p>The most up-to-date SNT API can be found at <a rel="nofollow" class="external free" href="https://morphonets.github.io/SNT">https://morphonets.github.io/SNT</a>.
</p>
<h2><span class="mw-headline" id="Script_Templates">Script Templates</span></h2>
<div class="thumb tright"><div class="thumbinner" style="width:302px;"><a href="File:Snt-Scripts-Menu-Full-List.png" class="image"><img alt="" src="_images/0/0f/Snt-Scripts-Menu-Full-List.png" width="300" height="358" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="File:Snt-Scripts-Menu-Full-List.png" class="internal" title="Enlarge"></a></div>SNT Scripts Menu</div></div></div>
<p>SNT comes packaged with script templates demonstrating 
various analysis, tracing, image processing and batch processing routines. These templates can be found both in the <i>Scripts</i> menu of the SNT dialog and in the <span><em><span style="border-bottom:1px dotted #ccc;">Templates</span>&#160;&#8250; <span style="border-bottom:1px dotted #ccc;">Neuroanatomy</span></em></span> menu of Fiji's Script Editor. Scripts can be written in any language supported by Fiji's Script Editor.
</p>
<h3><span class="mw-headline" id="Analysis">Analysis</span></h3>
<ul><li> <b>Analysis_Demo_(Interactive).py</b>  Exemplifies how to programmatically interact with a running instance of SNT to analyze traced data. Because of all the GUI updates, this approach is <i>significantly slower</i> than analyzing reconstructions directly (see Analysis_Demo.py for comparison)</li></ul>
<ul><li> <b>Analysis_Demo.py</b>  A <a href="Jython" class="mw-redirect" title="Jython">Jython</a> demo of how SNT can analyze neuronal reconstructions fetched from online databases such as MouseLight, NeuroMorpho or FlyCircuit.</li></ul>
<ul><li> <b>Download_ML_Data.groovy</b>  Exemplifies how to programmatically retrieve data from MouseLight's database at <a rel="nofollow" class="external text" href="http://ml-neuronbrowser.janelia.org/">ml-neuronbrowser.janelia.org</a>: It iterates through all the neurons in the server and downloads data (both JSON and SWC formats) for cells with soma associated with the specified Allen Reference Atlas (ARA) compartment. Downloaded files will contain all metadata associated with the cell (i.e., labeling used, strain, etc.)</li></ul>
<ul><li> <b>Get_Branch_Points_in_Brain_Compartment.groovy</b>  Exemplifies how to extract morphometric properties of a MouseLight cell associated with a specific brain region/neuropil compartment. Requires internet connection.</li></ul>
<ul><li> <b>Graph_Analysis.py</b>  Demonstrates how to handle neurons as graph structures <a rel="nofollow" class="external text" href="https://en.wikipedia.org/wiki/Graph_theory">(graph theory)</a> in which nodes connected by edges define the morphology of the neuron. SNT represents neurons as directed graphs (assuming the root -typically the soma- as origin) and allows data be processed using the powerful <a rel="nofollow" class="external text" href="https://jgrapht.org/">jgrapht</a> library. In this demo, the <a rel="nofollow" class="external text" href="http://mathworld.wolfram.com/GraphDiameter.html">graph diameter</a> (i.e., the length of the longest shortest path or the longest graph geodesic) of a cellular compartment is computed for a neuron fetched from the MouseLight database.</li></ul>
<ul><li> <b>Reconstruction_Viewer_Demo.py</b>  Exemplifies how to render reconstructions and neuropil annotations in a stand-alone <a href="SNT:_Reconstruction_Viewer" title="SNT: Reconstruction Viewer">Reconstruction Viewer</a>.</li></ul>
<ul><li> <b>SciView_Demo.groovy</b>  Exemplifies how bridge SNT with <a rel="nofollow" class="external text" href="SciView">SciView</a>.</li></ul>
<ul><li> <b>Extensive_Sholl_Stats.groovy</b>  Exemplifies how to perform linear and polynomial regression on tabular <a href="Sholl" class="mw-redirect" title="Sholl">Sholl</a> data. </li></ul>
<h3><span class="mw-headline" id="Boilerplate">Boilerplate</span></h3>
<p>This menu hosts script templates containing extensible boilerplate code in several programming languages, namely <a href="BeanShell" class="mw-redirect" title="BeanShell">BeanShell</a>, <a href="Groovy" class="mw-redirect" title="Groovy">Groovy</a> and <a href="Jython_Scripting" title="Jython Scripting">Jython</a>. The most essential imports and <a href="Script_Parameters" title="Script Parameters">script parameters</a> are included to facilitate rapid development.
</p>
<h3><span class="mw-headline" id="Tracing">Tracing</span></h3>
<ul><li> <b>Scripted_Tracing_Demo.py</b>  Exemplifies how to programmatically perform A* tracing between two points without GUI interaction, which allows for automated tracing of relatively simple structures (e.g., neurospheres neurites, microtubule bundles, etc). In this demo, points are retrieved from the SWC file of SNT's "demo tree", effectively recreating the initial SWC data.</li></ul>
<ul><li> <b>Scripted_Tracing_Demo_(Interactive).py</b>  Exemplifies how to programmatically interact with a running instance of SNT to perform auto-tracing tasks.</li></ul>
<ul><li> <b>Take_Snapshot.py</b>  Displays a WYSIWYG image of a tracing canvas. Exemplifies how to script SNT using SNTService.</li></ul>
<h3><span class="mw-headline" id="Batch">Batch</span></h3>
<p>This menu hosts scripts that process files in bulk. Namely:
</p>
<ul><li> <b>Convert_Traces_to_SWC.py</b>  Converts all .traces files in a directory into SWC.</li></ul>
<ul><li> <b>Filter_Multiple_Images.py</b>  Bulk filtering of image files using Frangi Vesselness.</li></ul>
<ul><li> <b>Measure_Multiple_Files.py</b>/<b>Measure_Multiple_Files_(With_Options).groovy</b>   Bulk measurements of reconstruction files.</li></ul>
<ul><li> <b>Render_Cell_Collection.groovy</b>  Exemplifies how to quickly render large collections of cells from a directory of files in <a href="SNT:_Reconstruction_Viewer" title="SNT: Reconstruction Viewer">Reconstruction Viewer</a>.</li></ul>
<ul><li> <b>Render_Cell_Collection_(MultiPanel_Figure).groovy</b>  Exemplifies how to generate a publication-quality multi-panel figure in which multiple reconstructions are sorted and color-coded by a specified morphometric trait (e.g., cable length).</li></ul>
<p><br />
</p>
<h2><span class="mw-headline" id="Python_Notebooks">Python Notebooks</span></h2>
<p>Direct access to the SNT API from the <a rel="nofollow" class="external text" href="https://www.python.org/">Python</a> programming language is made possible through the <a rel="nofollow" class="external text" href="https://pypi.org/project/pyimagej/">pyimagej</a> module. This enables full integration between SNT and any library in the Python ecosystem (numpy, scipy, etc.). The <a rel="nofollow" class="external text" href="https://github.com/morphonets/SNT/tree/master/notebooks">Notebooks</a> directory in the SNT repository contains several examples at different complexity levels.
</p><p>Here, we will exemplify basic functionality. Please refer to the complete <a rel="nofollow" class="external text" href="https://github.com/morphonets/SNT/tree/master/notebooks">examples</a> for more details. Once the Python environment is properly <a rel="nofollow" class="external text" href="https://github.com/morphonets/SNT/tree/master/notebooks#snt-notebooks">setup</a>, one can initialize Fiji:
</p>
<pre class="brush:python">
import imagej
ij = imagej.init('sc.fiji:fiji', headless=False)
</pre>
<p>Then, one can use <a rel="nofollow" class="external text" href="https://github.com/kivy/pyjnius">pyjnius</a> (bundled with pyimagej) to import the needed SNT (Java) classes. E.g., to download a neuron reconstruction from the MouseLight database and calculate summary statistics on it, you would import the <a rel="nofollow" class="external text" href="https://morphonets.github.io/SNT/index.html?sc/fiji/snt/io/MouseLightLoader.html">MouseLightLoader</a> and <a rel="nofollow" class="external text" href="https://morphonets.github.io/SNT/index.html?sc/fiji/snt/analysis/TreeStatistics.html">TreeStatistics</a> classes:
</p>
<pre class="brush:python">
from jnius import autoclass
MouseLightLoader = autoclass('tracing.io.MouseLightLoader')
TreeStatistics   = autoclass('tracing.analysis.TreeStatistics')
</pre>
<p>Now you can access all the attributes and methods these classes offer. Let's get a summary of the inter-node distances for a specific mouse cortical motor neuron (ID = "AA0100" in the <a rel="nofollow" class="external text" href="https://ml-neuronbrowser.janelia.org/">MouseLight database</a>). 
</p>
<pre class="brush:python">
def run():
    loader = MouseLightLoader("AA0100")
    if not loader.isDatabaseAvailable():
        print("Could not connect to ML database", "Error")
        return
    if not loader.idExists():
        print("Somehow the specified id was not found", "Error")
        return

    a_tree = loader.getTree('axon', None) # compartment, color
    s_stats = TreeStatistics(a_tree)
    metric = TreeStatistics.INTER_NODE_DISTANCE
    summary_stats = s_stats.getSummaryStats(metric)
    s_stats.getHistogram(metric).show()
    print("The average inter-node distance is&#160;%d"&#160;% summary_stats.getMean())
</pre>
<p><br />
</p>
<h2><span class="mw-headline" id="Adding_Scripts_to_SNT">Adding Scripts to SNT</span></h2>
<p>There are two ways to have your own scripts appear in SNT's <i>Scripts</i> menu. The easiest way is to go to <span><em><span style="border-bottom:1px dotted #ccc;">Scripts</span>&#160;&#8250; <span style="border-bottom:1px dotted #ccc;">New...</span></em></span> from the SNT dialog. This command will open an instance of Fiji's Script Editor with pre-loaded boilerplate code in the scripting language of your choice. If you save the script and then choose <span><em><span style="border-bottom:1px dotted #ccc;">Scripts</span>&#160;&#8250; <span style="border-bottom:1px dotted #ccc;">Reload...</span></em></span>, your new script will appear in the full list of scripts found at <span><em><span style="border-bottom:1px dotted #ccc;">Scripts</span>&#160;&#8250; <span style="border-bottom:1px dotted #ccc;">Full List...</span></em></span>.
</p><p>Alternatively, you can save scripts into the "scripts" sub-directory under the main Fiji directory while including <i>SNT</i> in the filename (e.g., <tt>C:\Users\user\Desktop\Fiji.app\scripts\My_SNT_Script.py</tt> or <tt>/home/user/Fiji.app/scripts/My_SNT_Script.py</tt>).
</p><p>Did you write a useful script? Please submit a <a rel="nofollow" class="external text" href="https://github.com/morphonets/SNT/pulls">pull request</a> on GitHub so that it can be distributed with Fiji!
</p><p><br />
</p>
<h2><span class="mw-headline" id="Examples">Examples</span></h2>
<h3><span class="mw-headline" id="Scripting_Reconstruction_Viewer">Scripting Reconstruction Viewer</span></h3>
<p>Programmatic control over an open instance of <a href="SNT:_Reconstruction_Viewer" title="SNT: Reconstruction Viewer">Reconstruction Viewer</a> (either called from within SNT or as a standalone application) can be achieved by selecting the <span><em><span style="border-bottom:1px dotted #ccc;">Tools &amp; Utilities</span>&#160;&#8250; <span style="border-bottom:1px dotted #ccc;">Script This Viewer...</span></em></span> <a href="SNT:_Reconstruction_Viewer#Utilities" title="SNT: Reconstruction Viewer">command</a>. It will then open an instance of Fiji's script editor with a boilerplate template containing the most essential imports and <a href="Script_Parameters" title="Script Parameters">script parameters</a>. The default programming language for this template can be chosen from the drop-down menu of the <i>Preferred Language</i> <a href="SNT:_Reconstruction_Viewer#Settings" title="SNT: Reconstruction Viewer">option</a>.
</p><p>The following script exemplifies how to extend the boilerplate template to control the Viewer in real-time.
</p>
<pre class="brush:python">
#@ Context context
#@ DatasetService ds
#@ DisplayService display
#@ ImageJ ij
#@ LegacyService ls
#@ LogService log
#@ LUTService lut
#@ SNTService snt
#@ UIService ui


"""
file:    
version: 
info:   
"""

from sc.fiji.snt import (Path, PathAndFillManager, SNT, SNTUI, Tree)
from sc.fiji.snt.analysis import (MultiTreeColorMapper, PathProfiler, RoiConverter,
        TreeAnalyzer, TreeColorMapper, TreeStatistics)
from sc.fiji.snt.analysis.graph import GraphUtils
from sc.fiji.snt.analysis.sholl import TreeParser
from sc.fiji.snt.annotation import (AllenCompartment, AllenUtils, VFBUtils, ZBAtlasUtils)
from sc.fiji.snt.io import (FlyCircuitLoader, MouseLightLoader, NeuroMorphoLoader)
from sc.fiji.snt.plugin import (SkeletonizerCmd, StrahlerCmd)
from sc.fiji.snt.util import (BoundingBox, PointInImage, SNTColor, SWCPoint)
from sc.fiji.snt.viewer import (Annotation3D, OBJMesh, MultiViewer2D, Viewer2D, Viewer3D)

# Documentation Resources: https://imagej.net/SNT:_Scripting
# SNT API: https://morphonets.github.io/SNT
# Rec. Viewer's API: https://morphonets.github.io/SNT/index.html?sc/fiji/snt/viewer/Viewer3D.html
# Tip: Programmatic control of the Viewer's scene can be set using the Console info
# produced when calling viewer.logSceneControls() or pressing 'L' when viewer is frontmost

# If opening this template from the standalone RV, the instance ID of the Viewer (e.g., 2)
# will be automatically passed as a parameter to getRecViewer()
viewer = snt.getRecViewer()


# Added code begins here ##################################################################
import time

def do_stuff(viewer):

    viewer.logSceneControls()
    
    # Load a neuron from Mouse Secondary Motor Area from the MouseLight database.
    loader = MouseLightLoader("AA0100")
    if not loader.isDatabaseAvailable():
        ui.showDialog("Could not connect to ML database", "Error")
        return
    if not loader.idExists():
        ui.showDialog("Somehow the specified id was not found", "Error")
        return

    # Extract nodes with tag "axon".
    axon = loader.getTree('axon')
    # Do the same for the dendrites.
    dendrites = loader.getTree('dendrites')

    # Load the Allen CCF Mouse Reference Brain
    # and add it to the scene.
    viewer.loadRefBrain('mouse')

    # Add both Trees to the scene
    viewer.addTree(axon)
    dendrites.setColor('cyan')
    viewer.addTree(dendrites)

    # Get the OBJMesh object representing the maximum depth Allen CCF compartment
    # containing the soma point and add it to the scene.
    soma_annotation = loader.getSomaCompartment()
    viewer.addMesh(soma_annotation.getMesh())

    # Enforce side perspective.
    viewer.setViewMode('side')

    # Next, we will applying a color mapping to the axon
    # using branch order as the metric and the Ice Lut.
    # Make an instance of TreeColorMapper using SciJava context.
    mapper = TreeColorMapper(context)
    # Get the net.imglib2.display.ColorTable object.
    lut = mapper.getColorTable('Ice.lut')
    # Color code the axon and render in scene.
    # The min and max values returned by the mapper are used
    # to set the range of the color bar legend.
    bounds = viewer.colorCode(axon.getLabel(), TreeColorMapper.STRAHLER_NUMBER, lut)
    viewer.addColorBarLegend(lut, bounds[0], bounds[1])
    # Display a text annotation of the cell ID and metric used by the mapper.
    scene_annotation = "{}: Branch Order".format(axon.getLabel())
    viewer.addLabel(scene_annotation)

    # Begin a rotation animation for the objects in scene.
    viewer.setAnimationEnabled(True)
    # Wait some time before applying a new color mapping
    # based on path distances, using a different LUT (Fire).
    time.sleep(5)
    
    lut = mapper.getColorTable('Fire.lut')
    # Remap the axon Tree and update scene.
    bounds = viewer.colorCode(axon.getLabel(), TreeColorMapper.PATH_DISTANCE, lut)
    viewer.addColorBarLegend(lut, bounds[0], bounds[1])
    scene_annotation = "{}: Path Distance".format(axon.getLabel())
    viewer.addLabel(scene_annotation)
    

do_stuff(viewer)

</pre>
<h3><span class="mw-headline" id="Script_Interpreter">Script Interpreter</span></h3>
<p>Some of SNT's functionality is accessible in the <a href="Script_Interpreter" title="Script Interpreter">Script Interpreter</a>. Here is an example:
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:652px;"><a href="File:SNT-ScriptInterpreter.png" class="image"><img alt="SNT-ScriptInterpreter.png" src="_images/6/60/SNT-ScriptInterpreter.png" width="650" height="506" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="File:SNT-ScriptInterpreter.png" class="internal" title="Enlarge"></a></div></div></div></div></div>
<p><br />
</p>
<div class="project-info">
<span class="project-logo"><a href="SNT" title="SNT"><img class="simple-tooltip simple-tooltip-img" data-simple-tooltip="This page describes content which is part of SNT. Click the logo for details." src="_images/5/5d/SNTLogo512.png"></img></a></span></div>
<table style="width:100%; background:#F6F9ED; border:1px solid #AAA; border-collapse:collapse; clear:both; font-size:85%;">
<tr>
<td style="background:#EEF3E2"><b><a href="SNT" title="SNT">Home</a></b>
</td>
<td style="text-align:center;"> <a href="SNT:_Manual" title="SNT: Manual">Manual</a>
</td>
<td style="text-align:center;"> <a href="SNT:_Step-By-Step_Instructions" title="SNT: Step-By-Step Instructions">Walk-throughs</a>
</td>
<td style="text-align:center;"> <a href="SNT:_Screencasts" title="SNT: Screencasts">Screencasts</a>
</td>
<td style="text-align:center;"> <a href="SNT:_Key_Shortcuts" title="SNT: Key Shortcuts">Shortcuts</a>
</td>
<td style="text-align:center;"> <a href="SNT:_Reconstruction_Viewer" title="SNT: Reconstruction Viewer">Rec. Viewer</a>
</td>
<td style="text-align:center;"> <a href="SNT:_Analysis" title="SNT: Analysis">Analysis</a>
</td>
<td style="text-align:center;"> <strong class="selflink">Scripting</strong>
</td>
<td style="text-align:center;"> <a href="SNT:_Modeling" title="SNT: Modeling">Modeling</a>
</td>
<td style="text-align:center;"> <a href="SNT:_FAQ" title="SNT: FAQ">FAQ</a>
</td></tr></table>
<div style="clear:both;"></div></div>

<!-- 
NewPP limit report
Cached time: 20200713073254
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.056 seconds
Real time usage: 0.054 seconds
Preprocessor visited node count: 373/1000000
Preprocessor generated node count: 1091/1000000
Post‐expand include size: 3740/2097152 bytes
Template argument size: 229/2097152 bytes
Highest expansion depth: 6/40
Expensive parser function count: 0/3
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%   14.239      1 - -total
 59.52%    8.475      5 - Template:Bc
 33.45%    4.763      2 - Template:SNTNavBar
 15.46%    2.202      5 - Template:Arrow
 12.77%    1.818      1 - Template:Project
  5.15%    0.733      1 - Template:Clear
-->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="index.php?title=SNT:_Scripting&amp;oldid=45678">http://imagej.net/index.php?title=SNT:_Scripting&amp;oldid=45678</a>"</div>
							</div>

			<div id="footer">
				<p> This page was last modified on 15 June 2020, at 00:01.</p><ul><li><a href="ImageJ:Privacy_policy" title="ImageJ:Privacy policy">Privacy policy</a></li><li><a href="ImageJ:About" class="mw-redirect" title="ImageJ:About">About ImageJ</a></li><li><a href="Imprint" title="Imprint">Imprint</a></li><li><a href="index.php?title=SNT:_Scripting&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li></ul>			</div>

			<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="index.php?title=Category:SNT&amp;action=edit&amp;redlink=1" class="new" title="Category:SNT (page does not exist)">SNT</a></li><li><a href="Category:Neuroanatomy" title="Category:Neuroanatomy">Neuroanatomy</a></li><li><a href="Category:Scripting" title="Category:Scripting">Scripting</a></li></ul></div></div>		</div>

		<div id="bottom-wrap">
		<div id="footer-wrap-inner">

		<div id="primary" class="footer">
			<ul>

			<li id="search" class="widget">
				<h3>Search</h3>
				<form action="http://imagej.net/index.php" id="searchform">
					<input type='hidden' name="title" value="Special:Search" />
					<div>
						<input name="search" placeholder="Search ImageJ" title="Search ImageJ [f]" accesskey="f" id="s"/>						<input type="submit" name="go" value="Search" title="Go to a page with this exact name if it exists" class="searchButton" id="searchsubmit"/>					</div>
				</form>
			</li>

			
						<li class="widget">
				<h3>Personal tools</h3>
				<div>
					<ul>
					<li id="pt-createaccount"><a href="index.php?title=Special:CreateAccount&amp;returnto=SNT%3A+Scripting" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="index.php?title=Special:UserLogin&amp;returnto=SNT%3A+Scripting" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>					</ul>
				</div>
			</li>
			
			<li class="widget">
							</li>

			</ul>
		</div>

		<div id="secondary" class="footer">
			<ul>

			<li id="toolbox" class="widget">
				<h3>Tools</h3>
				<ul>
				<li id="t-whatlinkshere"><a href="Special:WhatLinksHere/SNT:_Scripting" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special:RecentChangesLinked/SNT:_Scripting" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="index.php?title=SNT:_Scripting&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="index.php?title=SNT:_Scripting&amp;oldid=45678" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="index.php?title=SNT:_Scripting&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
			</li>

			
			<li class="widget">
							</li>

			</ul>
		</div>

		<div id="ternary" class="footer">
			<ul>

			<li class="widget">
				<img id="logo" src="skins/imagej-128.png" alt=""/>			</li>

			<li class="widget">
				<h3><span class="mw-headline" id="MORE_TOOLS">MORE TOOLS</span></h3>
<ul><li> <a href="Special:ChangeUploadPassword" title="Special:ChangeUploadPassword">Set/change upload password</a></li>
<li> <a href="Special:RecentChanges" title="Special:RecentChanges">Recent changes</a></li>
<li> <a href="Special:LonelyPages" title="Special:LonelyPages">Orphaned pages</a></li></ul>
			</li>

			</ul>
		</div>
		<div style="clear: both"></div>

		</div>
		</div>

		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.load(["ext.fancytree","ext.suckerfish","mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.SimpleTooltip"]);});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":243});});</script>
		</body>
		</html>
		