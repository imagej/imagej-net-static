<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>IsletJ2 - ImageJ</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"IsletJ2","wgTitle":"IsletJ2","wgCurRevisionId":42546,"wgRevisionId":42546,"wgArticleId":11090,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"IsletJ2","wgRelevantArticleId":11090,"wgRequestId":"f62fd12f49c998af06b76bed","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgPreferredVariant":"en","fancytree_path":"/extensions/TreeAndMenu/fancytree"});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user.cssprefs":"ready","user":"ready","user.options":"loading","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","skins.erudite":"ready"});mw.loader.implement("user.options@0j3lz3q",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens@1ku9xth",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.page.startup"]);});</script>
<link rel="stylesheet" href="erudite14.css"/>
<link rel="stylesheet" href="extensions/TreeAndMenu/fancytree/fancytree.css"/><link rel="stylesheet" href="extensions/TreeAndMenu/suckerfish/suckerfish.css"/>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="erudite15.css"/>
<meta name="generator" content="MediaWiki 1.28.0"/>
<meta name="description" content="IsletJ2 is a tool implemented as an ImageJ plugin that segments and reports properties of the Langerhans islets. The plugin was available already in 2018 under name IsletJ. However, many changes have been implemented since then. The original version can be found here."/>
<link rel="shortcut icon" href="skins/ij2.ico"/>

<script type="text/javascript" src="extensions/SyntaxHighlighter/syntaxhighlighter/scripts/shCore.js"></script>
<script type="text/javascript" src="extensions/SyntaxHighlighter/syntaxhighlighter/scripts/shBrushPlain.js"></script>
<script type="text/javascript">
SyntaxHighlighter.all();
</script>
<link rel="stylesheet" type="text/css" media="screen" href="extensions/SyntaxHighlighter/syntaxhighlighter/styles/shCoreMinit.css" />

	<meta property="og:type" content="article"/>

	<meta property="og:site_name" content="ImageJ"/>

	<meta property="og:title" content="IsletJ2"/>

	<meta property="og:description" content="IsletJ2 is a tool implemented as an ImageJ plugin that segments and reports properties of the Langerhans islets. The plugin was available already in 2018 under name IsletJ. However, many changes have been implemented since then. The original version can be found here."/>


<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-IsletJ2 rootpage-IsletJ2 skin-erudite action-view">
		<div class="mw-jump">
			<a href="IsletJ2.html#bodyContent">Skip to content</a>, 			<a href="IsletJ2.html#search">Skip to search</a>
		</div>

		<div id="top-wrap" role="banner">
			<h1><a href="Welcome" title="ImageJ" rel="home">ImageJ</a></h1>
			<div id="tagline">From ImageJ</div>

			<a id="menubutton" href="IsletJ2.html#menu">Menu</a>
			<div id="nav" role="navigation">
			<ul id='menu'>
<li id="menu-item-n-About"><a href="ImageJ">About</a></li>
<li id="menu-item-n-Downloads"><a href="Downloads">Downloads</a></li>
<li id="menu-item-n-Learn"><a href="Learn">Learn</a></li>
<li id="menu-item-n-Develop"><a href="Development">Develop</a></li>
<li id="menu-item-n-News"><a href="News">News</a></li>
<li id="menu-item-n-Events"><a href="Events">Events</a></li>
<li id="menu-item-n-Help"><a href="Help">Help</a></li>
</ul>
			</div>
		</div>

		<div id="mw-js-message"></div>
		
		<div id="main" role="main">

			<div id="bodyContent">
				<h1>IsletJ2</h1>
				
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="IsletJ2.html#General"><span class="tocnumber">1</span> <span class="toctext">General</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="IsletJ2.html#Installation"><span class="tocnumber">2</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="IsletJ2.html#Training"><span class="tocnumber">3</span> <span class="toctext">Training</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="IsletJ2.html#Training_protocol"><span class="tocnumber">3.1</span> <span class="toctext">Training protocol</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="IsletJ2.html#Analysis"><span class="tocnumber">4</span> <span class="toctext">Analysis</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="IsletJ2.html#Analysis_protocol"><span class="tocnumber">4.1</span> <span class="toctext">Analysis protocol</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="IsletJ2.html#Demo"><span class="tocnumber">5</span> <span class="toctext">Demo</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="IsletJ2.html#Pretrained_models"><span class="tocnumber">6</span> <span class="toctext">Pretrained models</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="IsletJ2.html#Tips"><span class="tocnumber">7</span> <span class="toctext">Tips</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="IsletJ2.html#Keyboard_shortcuts"><span class="tocnumber">7.1</span> <span class="toctext">Keyboard shortcuts</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="IsletJ2.html#Determining_the_pixel_size"><span class="tocnumber">7.2</span> <span class="toctext">Determining the pixel size</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="IsletJ2.html#Acknowledgements"><span class="tocnumber">8</span> <span class="toctext">Acknowledgements</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="General">General</span></h2>
<p>IsletJ2 is a tool implemented as an ImageJ plugin that segments and reports properties of the Langerhans islets. The plugin was available already in 2018 under name <a rel="nofollow" class="external text" href="IsletJ">IsletJ</a>. However, many changes have been implemented since then. The original version can be found <a rel="nofollow" class="external text" href="IsletJ">here</a>.
</p><p>Perhaps the most noticable change is the new graphical user interface (GUI). We made the GUI simpler and hopefully, more comfortable to use.
</p><p>Despite being invisible to users, massive changes have been done in the plugin core. The whole plugin has been rewritten from the ground up, resulting in more modular and extensible code and lesser demands on computing resources. The plugin, however, still employs the same approach as before.
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>The plugin was tested to work with ImageJ 1.52 (Fiji distribution) and Java 8. Follow these steps (a general procedure to install an ImageJ plugin) to install the plugin:
</p>
<ol><li> Start ImageJ and start updater using <code>Help</code> – <code>Update...</code>.</li>
<li> Click <code>Manage update sites</code> and add a new site using <code>Add update site</code>, then enter a name (e.g., <code>IsletJ2</code>) and URL <code><a rel="nofollow" class="external free" href="https://sites.imagej.net/IsletJ2/">https://sites.imagej.net/IsletJ2/</a></code>. Close the dialog.</li>
<li> Click <code>Apply changes</code> to fetch and install the plugin.</li>
<li> Restart ImageJ.</li></ol>
<h2><span class="mw-headline" id="Training">Training</span></h2>
<p>The training procedure consists of three consecutive phases:
</p>
<ol><li> sample loading,</li>
<li> ground truth verification,</li>
<li> and model training.</li></ol>
<p>In the first phase, a user select a directory that contains input images together with their corresponding ground truth images. IsletJ2 expects the names of the input files to have a specific format consisting of a prefix, a single underscore, and a number. The plugin uses the prefix to group the images and the ground truths, respectively, which means that all the images must have a common
prefix, and the same holds for the ground truths as well. The underscore serves purely as a delimiter between the preceding prefix and the following number. Finally, the number connects an image with its ground truth. For example, the names can be set as follows.
</p>
<pre class="brush:plain">
gt_01.png
gt_02.png
image_01.png
image_02.png
</pre>
<p>After the images are loaded and displayed to a user, the user should verify that the plugin recognized the images and ground truths correctly. If the retrieved segmentations are correct, it is possible to advance to the last phase.
</p><p>The last phase deals with model training. It is required to set a path where a model will be saved. Then, after pressing the <code>Train</code> button, the plugin will extract features from the images and start training the model.
</p><p><b>Note:</b> When the training starts, the values of the form inputs are saved and will be used to pre-fill the form in the next training.
</p><p><b>Note:</b> The training will probably take several minutes (depending on the number and size of the input images, or your computer performance). It also uses a lot of CPU and operational memory.
</p>
<h3><span class="mw-headline" id="Training_protocol">Training protocol</span></h3>
<p>Once the training finishes, a protocol is composed and saved to the same directory as the trained model. The protocol is a CSV file with two columns per row. Each row represents a single training example: the first and the second column contain paths to the example image and ground truth, respectively. The protocol name has a particular form, namely <code>isletj_MODEL_YYYY-MM-DD_hh-mm-ss.csv</code>, where <code>MODEL</code> is the model name, and <code>YYYY-MM-DD_hh-mm-ss</code> specifies the date and time when the protocol was created, e.g., <code>isletj_model-file.gz_2019-12-19_14-23-31.csv</code>.
</p>
<h2><span class="mw-headline" id="Analysis">Analysis</span></h2>
<p>The analysis assumes that there is a trained model somewhere in the file system.
</p><p>Contrary to the training, the analysis form is straightforward. It consists of five inputs that specify:
</p>
<ol><li> a path to a directory containing images to analyze (or choose to analyze the currently active image),</li>
<li> the size of a pixel in micrometers,</li>
<li> the minimal diameter of islets to consider,</li>
<li> a path to the trained model,</li>
<li> a path to a directory to save the analysis output.</li></ol>
<p>The selected input directory must exist and must contain at least one image. Currently, the plugin supports PNG format.
</p><p>The output directory must exist; and if it is not empty, the plugin will ask for a confirmation. The directory will contain a segmentation for each input image and a protocol.
</p><p><b>Note:</b> The input values will be saved and pre-filled for further analyses.
</p>
<h3><span class="mw-headline" id="Analysis_protocol">Analysis protocol</span></h3>
<p>Similarly to the training protocol, the analysis protocol is a CSV file. There is a row for each input image and consists of 4+15 columns:
</p>
<ol><li> path to the input image,</li>
<li> the number of recognized islets,</li>
<li> elliptical volume (in IEQ),</li>
<li> spherical volume (in IEQ),</li>
<li> the last 15 columns are for 15 different bins with diameter frequencies (based on the histogram of Ricordi).</li></ol>
<h2><span class="mw-headline" id="Demo">Demo</span></h2>
<p>The following steps show basic interaction with the plugin.
</p>
<ol><li> Download a demo <a rel="nofollow" class="external text" href="_images/5/59/Isletj-demo.zip">dataset</a> and extract the archive. Directory <code>isletj-demo</code> will be created containing one image and its ground truth segmentation.</li>
<li> Start ImageJ and open the dialog for training (<code>Plugins</code> – <code>IsletJ</code> – <code>Train</code>).</li>
<li> Select the extracted directory, set the prefixes of examples and GTs to <code>img_</code> and <code>gt_</code>, respectively, and click <code>Load</code> to load the dataset. Images (only a single one in this case) from the dataset will be displayed, and respective segmentations will be applied to the images resulting in green bordered regions.</li>
<li> Ensure that the segmentations were loaded correctly and click <code>Ok</code>.</li>
<li> Select a file path where the trained model should be saved and start training by clicking on <code>Train</code>. The name of the model can be arbitrary, but we suggest to use suffix <code>.gz</code> since then compression will be used, resulting in a smaller size of the model. </li>
<li> Wait until the training finishes. It should take only a few seconds in case of the demo.</li>
<li> Close the dialog for training and open the one for analysis (<code>Plugins</code> – <code>IsletJ</code> – <code>Analyze</code>).</li>
<li> Select the extracted directory as before (we will analyze the training image for the demo purposes), set an appropriate pixel size (e.g., 2.355 μm) and minimal size of islets (e.g., 0 μm), and select the previously trained model.</li>
<li> Select an output directory and click <code>Analyze</code>.</li></ol>
<h2><span class="mw-headline" id="Pretrained_models">Pretrained models</span></h2>
<p>Pretrained segmentation models can be downloaded <a rel="nofollow" class="external text" href="http://ptak.felk.cvut.cz/Medical/microscopy/IKEM/IsletJ/public/">here</a>. Note that future versions of IsletJ2 need not support older segmentation models. However, we will try to maintain a compatible model for each version. 
</p>
<h2><span class="mw-headline" id="Tips">Tips</span></h2>
<h3><span class="mw-headline" id="Keyboard_shortcuts">Keyboard shortcuts</span></h3>
<p>Should you use the plugin very frequently, it would be perhaps useful to access its features via some keyboard shortcuts.
</p><p>A new keyboard shortcut can be defined using <code>Plugins</code> – <code>Shortcuts</code> – <code>Add Shortcut...</code> in the top menu. In the displayed window, pick a shortcut of your choice (e.g., <code>F12</code>) and select <code>Analyze</code> or <code>Train</code> as the command.
</p><p>See <a rel="nofollow" class="external text" href="docs/guide/146-31.html#toc-Subsection-31.2.2">ImageJ docs</a> for more information on how to manage keyboard shortcuts in ImageJ.
</p>
<h3><span class="mw-headline" id="Determining_the_pixel_size">Determining the pixel size</span></h3>
<p>Take a photo of a stage micrometer and open the photo in Fiji. Use a straight line to measure the distance from 0 to 4. Then open <code>Analyze</code> – <code>Set Scale...</code> and fill the <code>Known distance</code> input. Fiji will compute the number of pixels per micrometer. Invert the number to get the number of micrometers per pixel.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:921px;"><div class="MediaTransformError" style="width: 919px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div>  <div class="thumbcaption">How to measure the pixel size. Taken from the <a rel="nofollow" class="external text" href="https://github.com/jschier/IsletJ/blob/master/pdf/IsletJ_Guide_2.pdf">documentation</a> of the original plugin version.</div></div></div></div>
<h2><span class="mw-headline" id="Acknowledgements">Acknowledgements</span></h2>
<p>The current implementation is heavily inspired by the previous implementation done by <i>Jan Schier</i>.
</p><p>The method used in the plugin was developed and described in the following work:
</p>
<ul><li> Habart, D. <i>et al.</i> (2016) ‘Automated Analysis of Microscopic Images of Isolated Pancreatic Islets’, <i>Cell Transplantation</i>, 25(12), pp. 2145–2156. doi: 10.3727/096368916X692005.</li></ul>

<!-- 
NewPP limit report
Cached time: 20200713072740
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.024 seconds
Real time usage: 0.023 seconds
Preprocessor visited node count: 56/1000000
Preprocessor generated node count: 72/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/3
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 - -total
-->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="index.php?title=IsletJ2&amp;oldid=42546">http://imagej.net/index.php?title=IsletJ2&amp;oldid=42546</a>"</div>
							</div>

			<div id="footer">
				<p> This page was last modified on 12 February 2020, at 05:59.</p><ul><li><a href="./ImageJ:Privacy_policy" title="ImageJ:Privacy policy">Privacy policy</a></li><li><a href="./ImageJ:About" class="mw-redirect" title="ImageJ:About">About ImageJ</a></li><li><a href="Imprint" title="Imprint">Imprint</a></li></ul>			</div>

			<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>		</div>

		<div id="bottom-wrap">
			<div id="footer-wrap-inner">
				<div id="ternary" class="footer">
					<ul>
						<li class="widget">
							<img id="logo" src="skins/imagej-128.png" alt="">
						</li>
					</ul>
				</div>
			</div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.load(["ext.fancytree","ext.suckerfish","mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.SimpleTooltip"]);});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":212});});</script>
		</body>
		</html>
		