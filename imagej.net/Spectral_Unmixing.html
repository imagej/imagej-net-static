<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>LUMoS Spectral Unmixing - ImageJ</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"LUMoS_Spectral_Unmixing","wgTitle":"LUMoS Spectral Unmixing","wgCurRevisionId":41161,"wgRevisionId":41161,"wgArticleId":10870,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Plugins","Color processing","Colocalization"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"LUMoS_Spectral_Unmixing","wgRelevantArticleId":10870,"wgRequestId":"4f4b92bd7a6bb2bf45c6afa9","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgPreferredVariant":"en","fancytree_path":"/extensions/TreeAndMenu/fancytree"});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user.cssprefs":"ready","user":"ready","user.options":"loading","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","skins.erudite":"ready"});mw.loader.implement("user.options@0j3lz3q",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens@1ku9xth",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.page.startup"]);});</script>
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%252Cshared%257Cmediawiki.sectionAnchor%257Cskins.erudite&amp;only=styles&amp;skin=erudite.css"/>
<script async="" src="load.php%3Fdebug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=erudite"></script>
<link rel="stylesheet" href="extensions/TreeAndMenu/fancytree/fancytree.css"/><link rel="stylesheet" href="extensions/TreeAndMenu/suckerfish/suckerfish.css"/>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=erudite.css"/>
<meta name="generator" content="MediaWiki 1.28.0"/>
<meta name="description" content="Learning Unsupervised Means of Spectra (LUMoS) is a blind spectral unmixing method that uses k-means clustering to separate different features of a fluorescence microscopy image into a multi-channel image in which each output channel corresponds to a single fluorophore."/>
<link rel="shortcut icon" href="skins/ij2.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="ImageJ (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="api.php?action=rsd"/>
<link rel="alternate" type="application/atom+xml" title="ImageJ Atom feed" href="index.php?title=Special:RecentChanges&amp;feed=atom"/>
	<meta property="og:type" content="article"/>

	<meta property="og:site_name" content="ImageJ"/>

	<meta property="og:title" content="LUMoS Spectral Unmixing"/>

	<meta property="og:description" content="Learning Unsupervised Means of Spectra (LUMoS) is a blind spectral unmixing method that uses k-means clustering to separate different features of a fluorescence microscopy image into a multi-channel image in which each output channel corresponds to a single fluorophore."/>

	<meta property="og:url" content="http://imagej.net/LUMoS_Spectral_Unmixing"/>

<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-LUMoS_Spectral_Unmixing rootpage-LUMoS_Spectral_Unmixing skin-erudite action-view">
		<div class="mw-jump">
			<a href="Spectral_Unmixing.html#bodyContent">Skip to content</a>, 			<a href="Spectral_Unmixing.html#search">Skip to search</a>
		</div>

		<div id="top-wrap" role="banner">
			<h1><a href="Welcome" title="ImageJ" rel="home">ImageJ</a></h1>
			<div id="tagline">From ImageJ</div>

			<a id="menubutton" href="Spectral_Unmixing.html#menu">Menu</a>
			<div id="nav" role="navigation">
			<ul id='menu'>
<li id="menu-item-n-About"><a href="ImageJ">About</a></li>
<li id="menu-item-n-Downloads"><a href="Downloads">Downloads</a></li>
<li id="menu-item-n-Learn"><a href="Learn">Learn</a></li>
<li id="menu-item-n-Develop"><a href="Development">Develop</a></li>
<li id="menu-item-n-News"><a href="News">News</a></li>
<li id="menu-item-n-Events"><a href="Events">Events</a></li>
<li id="menu-item-n-Help"><a href="Help">Help</a></li>
</ul>
			</div>
		</div>

		<div id="mw-js-message"></div>
		
		<div id="main" role="main">
			<div id="nav-meta">
			<span id="ca-nstab-main" class="selected"><a href="Spectral_Unmixing.html" title="View the content page [c]" accesskey="c">Page</a></span><span class="meta-sep">|</span><span id="ca-talk" class="new"><a href="index.php?title=Talk:LUMoS_Spectral_Unmixing&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></span><span class="meta-sep">|</span><span id="ca-viewsource"><a href="index.php?title=LUMoS_Spectral_Unmixing&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span><span class="meta-sep">|</span><span id="ca-history"><a href="index.php?title=LUMoS_Spectral_Unmixing&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></span><span class="meta-sep">|</span>			</div>

			<div id="bodyContent">
				<h1>LUMoS Spectral Unmixing</h1>
				
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><table class="infobox" cellspacing="5" style="max-width: 31em; font-size: 90%; text-align: left; float: right; border: 1px solid #a0a0a0;">
<tr>
<th colspan="2" style="text-align: center; font-size: 130%;"> <div style="float: left"></div>LUMoS Spectral Unmixing (ImageJ/Fiji)<div style="clear: left;"></div>
</th></tr>
<tr>
<th> Author
</th>
<td> Tristan McRae
</td></tr>




<tr>
<th> Maintainer
</th>
<td> Tristan McRae
</td></tr>


<tr>
<th> Source
</th>
<td> <a rel="nofollow" class="external text" href="https://github.com/tristan-mcrae-rochester/Multiphoton-Image-Analysis/blob/master/Spectral%20Unmixing/Code/ImageJ-FIJI/LUMoS_Spectral_Unmixing.java">GitHub</a>
</td></tr>
<tr>
<th> Initial release
</th>
<td> June 2019
</td></tr>


<tr>
<th> Category
</th>
<td> <a href="Category:Plugins" title="Category:Plugins">Plugins</a>, <a href="Category:Color_processing" title="Category:Color processing">Color Processing</a>, <a href="Category:Colocalization" title="Category:Colocalization">Colocalization</a>
</td></tr>

</table>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Spectral_Unmixing.html#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="Spectral_Unmixing.html#Spectral_Overlap"><span class="tocnumber">2</span> <span class="toctext">Spectral Overlap</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="Spectral_Unmixing.html#K-means_clustering"><span class="tocnumber">3</span> <span class="toctext"><i>K</i>-means clustering</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="Spectral_Unmixing.html#K-means_for_spectral_unmixing"><span class="tocnumber">4</span> <span class="toctext"><i>K</i>-means for spectral unmixing</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="Spectral_Unmixing.html#Usage"><span class="tocnumber">5</span> <span class="toctext">Usage</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="Spectral_Unmixing.html#See_Also"><span class="tocnumber">6</span> <span class="toctext">See Also</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="Spectral_Unmixing.html#References"><span class="tocnumber">7</span> <span class="toctext">References</span></a></li>
</ul>
</div>

<h1><span class="mw-headline" id="Introduction">Introduction</span></h1>
<p>Learning Unsupervised Means of Spectra (LUMoS) is a blind spectral unmixing method that uses k-means clustering to separate different features of a fluorescence microscopy image into a multi-channel image in which each output channel corresponds to a single fluorophore. 
</p>
<h1><span class="mw-headline" id="Spectral_Overlap">Spectral Overlap</span></h1>
<p>Due to the overlapping emission spectra of fluorophores, fluorescence microscopy images often have bleed-through problems, leading to a false positive detection. This problem is almost unavoidable when the samples are labeled with three or more fluorophores and completely unavoidable when fluorophores outnumber detection channels.
</p>
<div class="center"><div class="floatnone"><a href="File:Spectral_overlap.png" class="image"><img alt="Spectral overlap.png" src="_images/d/d4/Spectral_overlap.png" width="1000" height="362" /></a></div></div>
<h1><span class="mw-headline" id="K-means_clustering"><i>K</i>-means clustering</span></h1>
<p><i>K</i>-means is an unsupervised learning clustering technique. Given a set of input datapoints, <i>k</i>-means clusters the points into <i>k</i> different groups based on their values. K-means defines clusters by iteratively calculating the centroid of each cluster and assigning datapoints to the nearest cluster centroid. This process is depicted below:
</p>
<div class="center"><div class="floatnone"><a href="File:K-means.png" class="image"><img alt="K-means.png" src="_images/f/fb/K-means.png" width="600" height="360" /></a></div></div>
<h1><span class="mw-headline" id="K-means_for_spectral_unmixing"><i>K</i>-means for spectral unmixing</span></h1>
<p>In the context of spectral unmixing, the inputs to <i>k</i>-means are individual pixels. Each pixel is represented by a <i>1 x n</i> vector where <i>n</i> is the number of detection channels in the image. This vector is referred to as the "spectral signature" of the pixel. Pixels with similar spectral signatures are grouped into the same cluster. Each cluster is then represented as an inividual channel in the output image. The output channels correspond to unmixed fluorophores. This process will also separate background, autofluorescence and colocalization into distinct output channels. 
</p>
<div class="center"><div class="floatnone"><a href="File:Spectral_unmixing_example.png" class="image"><img alt="Spectral unmixing example.png" src="_images/2/22/Spectral_unmixing_example.png" width="800" height="397" /></a></div></div>
<h1><span class="mw-headline" id="Usage">Usage</span></h1>
<p>To install the plugin in your ImageJ or Fiji installation, add the update site LUMoS. The procedure to follow an update site <a href="Following_an_update_site" title="Following an update site">can be found here</a>.
</p><p>Alternatively, a full Fiji distribution with LUMoS already packaged can be downloaded. Unlike the update site, this packaged download is PC only. <a rel="nofollow" class="external text" href="https://www.urmc.rochester.edu/MediaLibraries/URMCMedia/multiphoton-core/documents/Fiji-app-for-LUMoS-spectral-unmixing.zip">PC only download</a>. 
</p><p>A user guide for this plugin with step by step instructions can be found <a href="_images/5/5d/Spectral_Unmixing_User_Guide.pdf" class="internal" title="Spectral Unmixing User Guide.pdf"> here</a>.
</p>
<h1><span class="mw-headline" id="See_Also">See Also</span></h1>
<p>The following are alternative spectral unmixing ImageJ plugins. These plugins both use linear algebra based approaches. Linear unmixing approaches are not applicable in cases where fluorophores outnumber detection channels. Additionally, they both require manual ROI selection or single-fluorophore references which can be laborious to acquire. Apart from these constraints, both of these plugins can be very useful tools in the right settings.  
</p><p><a rel="nofollow" class="external text" href="https://imagej.nih.gov/ij/plugins/spectral-unmixing.html">Spectral Unmixing Plugins</a> by Joachim Walter
</p><p><a rel="nofollow" class="external text" href="https://imagej.nih.gov/ij/plugins/spectral-unmixing-plugin.html">Spectral Unmixing Plugin</a> by Seth Gammon
</p><p><br />
</p>
<h1><span class="mw-headline" id="References">References</span></h1>
<p>If you use this program to generate a publication, please cite the following:  
</p><p>[1] McRae TD, Oleksyn D, Miller J, Gao Y-R (2019) Robust blind spectral unmixing for fluorescence microscopy using unsupervised learning. PLoS ONE 14(12): e0225410. <a rel="nofollow" class="external free" href="https://doi.org/10.1371/journal.pone.0225410">https://doi.org/10.1371/journal.pone.0225410</a>
</p>
<!-- 
NewPP limit report
Cached time: 20200713073448
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.032 seconds
Real time usage: 0.035 seconds
Preprocessor visited node count: 89/1000000
Preprocessor generated node count: 543/1000000
Post‐expand include size: 1096/2097152 bytes
Template argument size: 649/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/3
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    3.582      1 - Template:Infobox
100.00%    3.582      1 - -total
-->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="index.php?title=LUMoS_Spectral_Unmixing&amp;oldid=41161">http://imagej.net/index.php?title=LUMoS_Spectral_Unmixing&amp;oldid=41161</a>"</div>
							</div>

			<div id="footer">
				<p> This page was last modified on 21 January 2020, at 10:44.</p><ul><li><a href="ImageJ:Privacy_policy" title="ImageJ:Privacy policy">Privacy policy</a></li><li><a href="ImageJ:About" class="mw-redirect" title="ImageJ:About">About ImageJ</a></li><li><a href="Imprint" title="Imprint">Imprint</a></li><li><a href="index.php?title=LUMoS_Spectral_Unmixing&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li></ul>			</div>

			<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="Category:Plugins" title="Category:Plugins">Plugins</a></li><li><a href="Category:Color_processing" title="Category:Color processing">Color processing</a></li><li><a href="Category:Colocalization" title="Category:Colocalization">Colocalization</a></li></ul></div></div>		</div>

		<div id="bottom-wrap">
		<div id="footer-wrap-inner">

		<div id="primary" class="footer">
			<ul>

			<li id="search" class="widget">
				<h3>Search</h3>
				<form action="http://imagej.net/index.php" id="searchform">
					<input type='hidden' name="title" value="Special:Search" />
					<div>
						<input name="search" placeholder="Search ImageJ" title="Search ImageJ [f]" accesskey="f" id="s"/>						<input type="submit" name="go" value="Search" title="Go to a page with this exact name if it exists" class="searchButton" id="searchsubmit"/>					</div>
				</form>
			</li>

			
						<li class="widget">
				<h3>Personal tools</h3>
				<div>
					<ul>
					<li id="pt-createaccount"><a href="index.php?title=Special:CreateAccount&amp;returnto=LUMoS+Spectral+Unmixing" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="index.php?title=Special:UserLogin&amp;returnto=LUMoS+Spectral+Unmixing" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>					</ul>
				</div>
			</li>
			
			<li class="widget">
							</li>

			</ul>
		</div>

		<div id="secondary" class="footer">
			<ul>

			<li id="toolbox" class="widget">
				<h3>Tools</h3>
				<ul>
				<li id="t-whatlinkshere"><a href="Special:WhatLinksHere/LUMoS_Spectral_Unmixing" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="Special:RecentChangesLinked/LUMoS_Spectral_Unmixing" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="index.php?title=LUMoS_Spectral_Unmixing&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="index.php?title=LUMoS_Spectral_Unmixing&amp;oldid=41161" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="index.php?title=LUMoS_Spectral_Unmixing&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
			</li>

			
			<li class="widget">
							</li>

			</ul>
		</div>

		<div id="ternary" class="footer">
			<ul>

			<li class="widget">
				<img id="logo" src="skins/imagej-128.png" alt=""/>			</li>

			<li class="widget">
				<h3><span class="mw-headline" id="MORE_TOOLS">MORE TOOLS</span></h3>
<ul><li> <a href="Special:ChangeUploadPassword" title="Special:ChangeUploadPassword">Set/change upload password</a></li>
<li> <a href="Special:RecentChanges" title="Special:RecentChanges">Recent changes</a></li>
<li> <a href="Special:LonelyPages" title="Special:LonelyPages">Orphaned pages</a></li></ul>
			</li>

			</ul>
		</div>
		<div style="clear: both"></div>

		</div>
		</div>

		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.load(["ext.fancytree","ext.suckerfish","mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.SimpleTooltip"]);});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":202});});</script>
		</body>
		</html>
		