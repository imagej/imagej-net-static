<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Uber-JAR - ImageJ</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Uber-JAR","wgTitle":"Uber-JAR","wgCurRevisionId":43531,"wgRevisionId":43531,"wgArticleId":2800,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Uber-JAR","wgRelevantArticleId":2800,"wgRequestId":"723e523bd28e420745a6d226","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgPreferredVariant":"en","fancytree_path":"/extensions/TreeAndMenu/fancytree"});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user.cssprefs":"ready","user":"ready","user.options":"loading","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","skins.erudite":"ready"});mw.loader.implement("user.options@0j3lz3q",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens@1ku9xth",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.page.startup"]);});</script>
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%252Cshared%257Cmediawiki.sectionAnchor%257Cskins.erudite&amp;only=styles&amp;skin=erudite.css"/>
<script async="" src="load.php%3Fdebug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=erudite"></script>
<link rel="stylesheet" href="extensions/TreeAndMenu/fancytree/fancytree.css"/><link rel="stylesheet" href="extensions/TreeAndMenu/suckerfish/suckerfish.css"/>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=erudite.css"/>
<meta name="generator" content="MediaWiki 1.28.0"/>
<meta name="description" content="An uber-JAR—also known as a fat JAR or JAR with dependencies—is a JAR file that contains not only a Java program, but embeds its dependencies as well. This means that the JAR functions as an &quot;all-in-one&quot; distribution of the software, without needing any other Java code. (You still need a Java runtime, and an underlying operating system, of course.)"/>
<link rel="shortcut icon" href="skins/ij2.ico"/>

<script type="text/javascript" src="extensions/SyntaxHighlighter/syntaxhighlighter/scripts/shCore.js"></script>
<script type="text/javascript" src="extensions/SyntaxHighlighter/syntaxhighlighter/scripts/shBrushXml.js"></script>
<script type="text/javascript">
SyntaxHighlighter.all();
</script>
<link rel="stylesheet" type="text/css" media="screen" href="extensions/SyntaxHighlighter/syntaxhighlighter/styles/shCoreMinit.css" />

	<meta property="og:type" content="article"/>

	<meta property="og:site_name" content="ImageJ"/>

	<meta property="og:title" content="Uber-JAR"/>

	<meta property="og:description" content="An uber-JAR—also known as a fat JAR or JAR with dependencies—is a JAR file that contains not only a Java program, but embeds its dependencies as well. This means that the JAR functions as an &quot;all-in-one&quot; distribution of the software, without needing any other Java code. (You still need a Java runtime, and an underlying operating system, of course.)"/>


<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Uber-JAR rootpage-Uber-JAR skin-erudite action-view">
		<div class="mw-jump">
			<a href="Uber-JARs.html#bodyContent">Skip to content</a>, 			<a href="Uber-JARs.html#search">Skip to search</a>
		</div>

		<div id="top-wrap" role="banner">
			<h1><a href="Welcome" title="ImageJ" rel="home">ImageJ</a></h1>
			<div id="tagline">From ImageJ</div>

			<a id="menubutton" href="Uber-JARs.html#menu">Menu</a>
			<div id="nav" role="navigation">
			<ul id='menu'>
<li id="menu-item-n-About"><a href="ImageJ">About</a></li>
<li id="menu-item-n-Downloads"><a href="Downloads">Downloads</a></li>
<li id="menu-item-n-Learn"><a href="Learn">Learn</a></li>
<li id="menu-item-n-Develop"><a href="Development">Develop</a></li>
<li id="menu-item-n-News"><a href="News">News</a></li>
<li id="menu-item-n-Events"><a href="Events">Events</a></li>
<li id="menu-item-n-Help"><a href="Help">Help</a></li>
</ul>
			</div>
		</div>

		<div id="mw-js-message"></div>
		
		<div id="main" role="main">
			<div id="nav-meta">
			<span id="ca-nstab-main" class="selected"><a href="Uber-JARs.html" title="View the content page [c]" accesskey="c">Page</a></span><span class="meta-sep">|</span><span id="ca-talk" class="new"><a href="index.php?title=Talk:Uber-JAR&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></span><span class="meta-sep">|</span><span id="ca-viewsource"><a href="index.php?title=Uber-JAR&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span><span class="meta-sep">|</span><span id="ca-history"><a href="index.php?title=Uber-JAR&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></span><span class="meta-sep">|</span>			</div>

			<div id="bodyContent">
				<h1>Uber-JAR</h1>
				
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><table class="infobox" cellspacing="5" style="text-align: left; float: right; border: 1px solid #a0a0a0; font-size: 80%;">
<tr>
<th colspan="2" style="font-size: 130%;">  Development
</th></tr>
<tr>
<td>
</td></tr>
<tr>
<td>
<table class="infobox mw-collapsible mw-collapsed" cellspacing="5" data-collapsetext="-" data-expandtext="+" style="width: 100%; text-align: left; border-top: 1px solid #336699; border-right: none; border-left: none; border-bottom: none;">
<tr>
<th>  Topics
</th></tr>


<tr>
<td>  <a href="Development" title="Development">Overview</a>
</td></tr>
<tr>
<td>  <a href="Philosophy" title="Philosophy">Philosophy</a>
</td></tr>
<tr>
<td>  <a href="Architecture" title="Architecture">Architecture</a>
</td></tr>
<tr>
<td>  <a href="Source_code" title="Source code">Source code</a>
</td></tr>
<tr>
<td>  <a href="Project_management" title="Project management">Project management</a>
</td></tr>
<tr>
<td>  <a href="Coding_style" title="Coding style">Coding style</a>
</td></tr>
<tr>
<td>  <a href="Debugging" title="Debugging">Debugging</a>
</td></tr></table>
</td></tr>
<tr>
<td>
<table class="infobox mw-collapsible mw-collapsed" cellspacing="5" data-collapsetext="-" data-expandtext="+" style="width: 100%; text-align: left; border-top: 1px solid #336699; border-right: none; border-left: none; border-bottom: none;">
<tr>
<th>  Tools
</th></tr>


<tr>
<td>  <a href="GitHub" title="GitHub">GitHub</a>
</td></tr>
<tr>
<td>  <a href="Git" title="Git">Git</a>
</td></tr>
<tr>
<td>  <a href="Maven" title="Maven">Maven</a>
</td></tr>
<tr>
<td>  <a href="IDEs" title="IDEs">IDEs</a>
</td></tr>
<tr>
<td>  <a href="Travis" title="Travis">Travis</a>
</td></tr>
<tr>
<td>  <a href="AppVeyor" title="AppVeyor">AppVeyor</a>
</td></tr>
<tr>
<td>  <a href="Dotfiles" title="Dotfiles">Dotfiles</a>
</td></tr></table>
</td></tr>
<tr>
<td>
<table class="infobox mw-collapsible" cellspacing="5" data-collapsetext="-" data-expandtext="+" style="width: 100%; text-align: left; border-top: 1px solid #336699; border-right: none; border-left: none; border-bottom: none;">
<tr>
<th>  Guides
</th></tr>


<tr>
<td>  <a href="Writing_plugins" title="Writing plugins">Writing plugins</a>
</td></tr>
<tr>
<td>  <a href="ImageJ_Ops" title="ImageJ Ops">ImageJ Ops</a>
</td></tr>
<tr>
<td>  <a href="How_to_contribute_to_an_existing_plugin_or_library" title="How to contribute to an existing plugin or library">Contributing to a plugin</a>
</td></tr>
<tr>
<td>  <a href="Distribution" title="Distribution">Distributing your plugins</a>
</td></tr>
<tr>
<td>  <a href="Development_Lifecycle" title="Development Lifecycle">Development lifecycle</a>
</td></tr>
<tr>
<td>  <a href="Building_a_POM" title="Building a POM">Building a POM</a>
<hr />
</td></tr>
<tr>
<td>  <a href="Developing_ImageJ_in_Eclipse" title="Developing ImageJ in Eclipse">Developing with Eclipse</a>
</td></tr>
<tr>
<td>  <a href="Debugging_Exercises" title="Debugging Exercises">Hands-on debugging</a>
</td></tr>
<tr>
<td>  <a href="Adding_new_ops" title="Adding new ops">Adding new ops</a>
</td></tr>
<tr>
<td>  <a href="Adding_new_formats" title="Adding new formats">Adding new formats</a>
</td></tr>
<tr>
<td>  <a href="Developing_using_native_libraries" title="Developing using native libraries">Using native libraries</a>
</td></tr>
<tr>
<td>  <a href="Tips_for_developers" title="Tips for developers">Tips for developers</a>
</td></tr>
<tr>
<td>  <a href="Tips_for_C%2B%2B_developers" title="Tips for C++ developers">Tips for C++ developers</a>
</td></tr>
<tr>
<td>  <a href="Introduction_into_Developing_Plugins" class="mw-redirect" title="Introduction into Developing Plugins">ImageJ 1.x plugins</a>
</td></tr>
<tr>
<td>  <a href="Versioning" title="Versioning">Versioning</a>
</td></tr>
<tr>
<td>  <a href="Logging" title="Logging">Logging</a>
</td></tr>
<tr>
<td>  <strong class="selflink">Uber-JARs</strong>
</td></tr></table>
</td></tr></table>
<p>An <b>uber-JAR</b>—also known as a <b>fat JAR</b> or <b>JAR with dependencies</b>—is a JAR file that contains not only a Java program, but embeds its dependencies as well. This means that the JAR functions as an "all-in-one" distribution of the software, without needing any other Java code. (You still need a Java runtime, and an underlying operating system, of course.)
</p>
<div style="overflow:hidden"><table class="metadata plainlinks ambox ambox-content">
<tr>
<td class="ambox-image">
<p><a href="File:Important-sign.png" class="image"><img alt="Important-sign.png" src="_images/f/f0/Important-sign.png" width="40" height="40" /></a>
</p>
</td>
<td> We recommend <i>against</i> using uber-JARs. They introduce many problems for downstream consumers. </td>
<p><br />
</p>
</tr>
</table></div>
<p><br />
</p>
<h2><span class="mw-headline" id="Approaches">Approaches</span></h2>
<p>There are three common methods for constructing an uber-JAR:
</p>
<ul>
<li><b>Unshaded.</b> Unpack all JAR files, then repack them into a single JAR.
  <ul>
  <li><b>Pro:</b> Works with Java's default class loader.</li>
  <li><b>Con:</b> Files present in multiple JAR files with the same path (e.g., <code>META-INF/services/javax.script.ScriptEngineFactory</code>) will overwrite one another, resulting in faulty behavior.</li>
  <li><b>Tools:</b> <a rel="nofollow" class="external text" href="http://maven.apache.org/plugins/maven-assembly-plugin/">Maven Assembly Plugin</a>, <a rel="nofollow" class="external text" href="http://classworlds.codehaus.org/uberjar.html">Classworlds Uberjar</a></li>
  </ul>
</li>
<li><b>Shaded.</b> Same as unshaded, but rename (i.e., "shade") all packages of all dependencies.
  <ul>
  <li><b>Pro:</b> Works with Java's default class loader. Avoids some (not all) dependency version clashes.</li>
  <li><b>Con:</b> Files present in multiple JAR files with the same path (e.g., <code>META-INF/services/javax.script.ScriptEngineFactory</code>) will overwrite one another, resulting in faulty behavior. As a workaround, if you use <a href="Maven" title="Maven">Maven</a>, you can add the following lines to the shade plugin section of the POM  to apply the appending tranform to multiple resources with the same name (e.g. <code>META-INF/json/org.scijava.plugin.Plugin</code> or <code>META-INF/json/mpicbg.spim.data.generic.sequence.ImgLoaderIo</code>). Both are annotations necessary to find interface or abstract class implementation during runtime across JARs:
<pre class="brush:xml">
&lt;transformers combine.children="append"&gt;
  &lt;transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer"&gt;
    &lt;resource&gt;META-INF/json/org.scijava.plugin.Plugin&lt;/resource&gt;
  &lt;/transformer&gt;
&lt;/transformers&gt;
</pre>
<p>If you need to append more than one file, you unfortunately need to list multiple <b>transformer implementations</b> as wildcards are not allowed. For appending two files, the entry would look like this:
</p>
<pre class="brush:xml">
&lt;transformers combine.children="append"&gt;
	&lt;transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer"&gt;
		&lt;resource&gt;META-INF/json/org.scijava.plugin.Plugin&lt;/resource&gt;
	&lt;/transformer&gt;
	&lt;transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer"&gt;
		&lt;resource&gt;META-INF/json/mpicbg.spim.data.generic.sequence.ImgLoaderIo&lt;/resource&gt;
	&lt;/transformer&gt;
&lt;/transformers&gt;
</pre>
<p>An example of a full maven-shade-plugin can be found <a rel="nofollow" class="external text" href="https://github.com/PreibischLab/multiview-reconstruction/blob/96d0f417638dab108f942e49ffa26024b48053f0/pom.xml#L271">here</a> (single entry) and <a rel="nofollow" class="external text" href="https://github.com/PreibischLab/BigStitcher/blob/eb1cc4af404ae83715135894920ed9c3b5e42385/pom.xml#L208">here</a> (multiple entries). 
</p>
  </li>
  <li><b>Tools:</b> <a rel="nofollow" class="external text" href="http://maven.apache.org/plugins/maven-shade-plugin/">Maven Shade Plugin</a></li>
  </ul>
</li>
<li><b>JAR of JARs</b>. The final JAR file contains the other JAR files embedded within.
  <ul>
  <li><b>Pro:</b> Avoids dependency version clashes. All resource files are preserved.</li>
  <li><b>Con:</b> Needs to bundle a special "bootstrap" classloader to enable Java to load classes from the wrapped JAR files. Debugging class loader issues becomes more complex.  Using getResource() calls when there are MANY contained jars can be problematic, due to locking inside misc.sun.URLClassPath.</li>
  <li><b>Tools:</b> <a rel="nofollow" class="external text" href="http://help.eclipse.org/luna/index.jsp?topic=%2Forg.eclipse.jdt.doc.user%2Freference%2Fref-export-jar.htm">Eclipse JAR File Exporter</a>, <a rel="nofollow" class="external text" href="http://one-jar.sourceforge.net/">One-JAR</a>.</li>
  </ul>
</li>
<h2><span class="mw-headline" id="Discussion">Discussion</span></h2>
<p><b>Advantages:</b> A single JAR file is simpler to deploy. There is no chance of mismatched versions of multiple JAR files. It is easier to construct a Java classpath, since only a single JAR needs to be included.
</p><p><b>Disadvantages:</b>
</p>
<ul><li> Every time you need to update the version of the software, you must redeploy the entire uber-JAR (e.g., <a href="ImageJ" title="ImageJ">ImageJ</a> is ~68 MB as of May 2015). If you bundle individual JAR components, you need only update those that changed. This issue is of particular relevance to Java applications deployed via Java Web Start, since it automatically downloads the latest available version of each JAR dependency; in that case, your application startup time will suffer if you use the uber-JAR.</li>
<li> You cannot cherry-pick only the JARs containing the functionality you need, so your application's footprint may suffer from bloat.</li>
<li> If downstream code relies on any of the same dependencies which are embedded in an unshaded uber-jar, you may run into trouble (e.g., <code><a href="Troubleshooting#NoSuchMethodError_or_NoClassDefFoundError" title="Troubleshooting">NoSuchMethodError</a></code> for unshaded uber-JARs) with multiple copies of those dependencies on your classpath, especially if you need to use a different version of that dependency than is bundled with the uber-JAR.</li></ul>
<p>As you can see, it is important to understand how use of the uber-JAR will affect your application. In particular, Java applications will likely be better served using the individual component JARs, ideally managed using a dependency management platform such as <a rel="nofollow" class="external text" href="http://maven.apache.org/">Maven</a> or <a rel="nofollow" class="external text" href="http://ant.apache.org/ivy/">Ivy</a>. But for non-Java applications, the uber-JAR may be sufficient to your needs.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li> <a rel="nofollow" class="external text" href="http://stackoverflow.com/q/11947037">What is an uber-jar?</a> on Stack Overflow</li>
<li> <a rel="nofollow" class="external text" href="http://dig.floatingsun.net/the-elusive-uber-jar/">The Elusive Uber Jar</a></ul></li></ul>

<!-- 
NewPP limit report
Cached time: 20200713074045
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.032 seconds
Real time usage: 0.035 seconds
Preprocessor visited node count: 307/1000000
Preprocessor generated node count: 823/1000000
Post‐expand include size: 7468/2097152 bytes
Template argument size: 3949/2097152 bytes
Highest expansion depth: 8/40
Expensive parser function count: 0/3
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%   11.592      1 - -total
 83.36%    9.663      1 - Template:DevelopMenu
 72.69%    8.427      1 - Template:Menu
 63.32%    7.341      3 - Template:Submenu
 31.38%    3.638     31 - Template:MenuItem
 16.12%    1.869      1 - Template:Warning
 10.72%    1.243      1 - Template:Ambox
-->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="index.php?title=Uber-JAR&amp;oldid=43531">http://imagej.net/index.php?title=Uber-JAR&amp;oldid=43531</a>"</div>
							</div>

			<div id="footer">
				<p> This page was last modified on 18 March 2020, at 10:22.</p><ul><li><a href="ImageJ:Privacy_policy" title="ImageJ:Privacy policy">Privacy policy</a></li><li><a href="ImageJ:About" class="mw-redirect" title="ImageJ:About">About ImageJ</a></li><li><a href="Imprint" title="Imprint">Imprint</a></li><li><a href="index.php?title=Uber-JAR&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li></ul>			</div>

			<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>		</div>

		<div id="bottom-wrap">
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.load(["ext.fancytree","ext.suckerfish","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.SimpleTooltip"]);});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":149});});</script>
		</body>
		</html>
		