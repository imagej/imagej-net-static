<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Uploading plugins - ImageJ</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Uploading_plugins","wgTitle":"Uploading plugins","wgCurRevisionId":22727,"wgRevisionId":22727,"wgArticleId":637,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Outdated","Development"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Uploading_plugins","wgRelevantArticleId":637,"wgRequestId":"ec7c65a645fb71da7efffc1c","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgPreferredVariant":"en","fancytree_path":"/extensions/TreeAndMenu/fancytree"});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user.cssprefs":"ready","user":"ready","user.options":"loading","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","skins.erudite":"ready"});mw.loader.implement("user.options@0j3lz3q",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens@1ku9xth",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.page.startup"]);});</script>
<link rel="stylesheet" href="erudite14.css"/>
<link rel="stylesheet" href="extensions/TreeAndMenu/fancytree/fancytree.css"/><link rel="stylesheet" href="extensions/TreeAndMenu/suckerfish/suckerfish.css"/>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="erudite15.css"/>
<meta name="generator" content="MediaWiki 1.28.0"/>
<meta name="description" content="Note: Please make sure that you have a clean build of the plugin you try to upload. You can ensure a clean build by calling the Fiji Build System with the -clean suffix before building the actual target. Example:"/>
<link rel="shortcut icon" href="skins/ij2.ico"/>
	<meta property="og:type" content="article"/>

	<meta property="og:site_name" content="ImageJ"/>

	<meta property="og:title" content="Uploading plugins"/>

	<meta property="og:description" content="Note: Please make sure that you have a clean build of the plugin you try to upload. You can ensure a clean build by calling the Fiji Build System with the -clean suffix before building the actual target. Example:"/>


<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Uploading_plugins rootpage-Uploading_plugins skin-erudite action-view">
		<div class="mw-jump">
			<a href="Uploading_plugins.html#bodyContent">Skip to content</a>, 			<a href="Uploading_plugins.html#search">Skip to search</a>
		</div>

		<div id="top-wrap" role="banner">
			<h1><a href="Welcome" title="ImageJ" rel="home">ImageJ</a></h1>
			<div id="tagline">From ImageJ</div>

			<a id="menubutton" href="Uploading_plugins.html#menu">Menu</a>
			<div id="nav" role="navigation">
			<ul id='menu'>
<li id="menu-item-n-About"><a href="ImageJ">About</a></li>
<li id="menu-item-n-Downloads"><a href="Downloads">Downloads</a></li>
<li id="menu-item-n-Learn"><a href="Learn">Learn</a></li>
<li id="menu-item-n-Develop"><a href="Development">Develop</a></li>
<li id="menu-item-n-News"><a href="News">News</a></li>
<li id="menu-item-n-Events"><a href="Events">Events</a></li>
<li id="menu-item-n-Help"><a href="Help">Help</a></li>
</ul>
			</div>
		</div>

		<div id="mw-js-message"></div>
		
		<div id="main" role="main">

			<div id="bodyContent">
				<div style="font-size: large; border: 1px solid black; padding: 1em; margin-bottom: 1em; text-align: center; background-color: #fda;">
					This is a read-only version of imagej.net, available during the transition to a new site.
					<br>Please direct any questions or issues to <a href="https://forum.image.sc/t/imagej-wiki-is-down/39672">this Image.sc Forum thread</a>.
					<br>Thank you for your patience as we improve the website!
				</div>

				<h1>Uploading plugins</h1>
				
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div style="overflow:hidden"><table class="metadata plainlinks ambox ambox-content">
<tr>
<td class="ambox-image">
<p><a href="./File:Important-sign.png" class="image"><img alt="Important-sign.png" src="_images/f/f0/Important-sign.png" width="40" height="40" /></a>
</p>
</td>
<td> This section is out of date, potentially misleading or invalid. Be careful with any instructions here. When in doubt, <a href="Help" title="Help">ask for help from the community</a>. </td>
<p><br />
</p>
</tr>
</table></div>
<p><b>Note</b>: Please make sure that you have a clean build of the plugin you try to upload. You can ensure a clean build by calling the <a href="Fiji_Build_System" class="mw-redirect" title="Fiji Build System">Fiji Build System</a> with the <i>-clean</i> suffix before building the actual target. Example:
</p>
<pre>./Build.sh plugins/Fiji_Plugins.jar-clean
./Build.sh plugins/Fiji_Plugins.jar
</pre>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Uploading_plugins.html#The_graphical_way_.28recommended.29"><span class="tocnumber">1</span> <span class="toctext">The graphical way (recommended)</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="Uploading_plugins.html#Using_the_command_line"><span class="tocnumber">2</span> <span class="toctext">Using the command line</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="Uploading_plugins.html#Internals"><span class="tocnumber">3</span> <span class="toctext">Internals</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="Uploading_plugins.html#Checksumming"><span class="tocnumber">3.1</span> <span class="toctext">Checksumming</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="Uploading_plugins.html#The_database"><span class="tocnumber">3.2</span> <span class="toctext">The database</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="Uploading_plugins.html#File_organization"><span class="tocnumber">4</span> <span class="toctext">File organization</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="Uploading_plugins.html#The_actual_files"><span class="tocnumber">5</span> <span class="toctext">The actual files</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="The_graphical_way_.28recommended.29">The graphical way (recommended)</span></h2>
<p>You can use the <a href="Update_Fiji" class="mw-redirect" title="Update Fiji">Fiji Updater</a> to upload new plugins (or new versions thereof). First start <span><em><span style="border-bottom:1px dotted #ccc;"> Help </span>&#160;&#8250; <span style="border-bottom:1px dotted #ccc;"> Update Fiji</span></em></span>. It will tell you that there are <i>locally modified files</i>:
</p>
<div class="center"><div class="floatnone"><a href="./File:Updater-locally-modified.png" class="image"><img alt="Updater-locally-modified.png" src="_images/1/1f/Updater-locally-modified.png" width="600" height="421" /></a></div></div>
<p>Please make sure that there are <u>no</u> updateable files, lest you overwrite new versions with old ones. If that is the case, the <i>Updater</i> will automatically switch to the <i>Advanced Mode</i> and show you the <i>locally modified files</i>. By clicking on the <i>Locally modified</i>, you can choose to upload one or more files:
</p>
<div class="center"><div class="floatnone"><a href="./File:Updater-select-upload.png" class="image"><img alt="Updater-select-upload.png" src="_images/2/22/Updater-select-upload.png" width="750" height="375" /></a></div></div>
<p><b>Note:</b> if you want to upload a new file, i.e. a file Fiji does not know anything about yet, you have to switch to <i>Advanced Mode</i> yourself and select the view option <i>View non-Fiji plugins only</i>.
</p><p>Please make sure that the information in the <i>Details</i> is correct; you can edit it by clicking into the text and modifying it in-place.
</p><p>Please make sure also that the files you are about to upload are clean. You should also use the <i>Show changes</i> button for an extra check -- in the top part, you will see information about changed and local-only/remote-only contents of the <i>.jar</i> file.
</p><p>Once everything is ready for upload, just click the button <i>Upload to Server</i>.
</p><p><b>Note:</b> you will need to have an account on <a href="Fiji.sc" title="Fiji.sc">fiji.sc</a> which is in the group <i>updaters</i>, and you will only be offered the upload option by the Updater if you work from a working directory with source files.
</p>
<h2><span class="mw-headline" id="Using_the_command_line">Using the command line</span></h2>
<p>If you have an ssh account on <i>fiji.sc</i> that is in the <i>uploaders</i> group, you can upload plugins.  To do this, run
</p>
<pre>git pull origin master
</pre>
<p>If this says that a recursive merge was performed, you had local changes and should <b>not</b> upload anything, as you did not test that version!
</p><p>If it was a fast-forward (or if Git said "Everything up-to-date"), you are good to go:
</p>
<pre>./Build.sh
./bin/update-fiji.py &lt;filename&gt;
</pre>
<p>It will refuse to upload a file that has locally-modified dependencies, and list them.  To upload those dependencies, too, you can use the <i>--auto</i> option of <i>./bin/update-fiji.py</i>.  <b>Use with care!</b>
</p>
<h2><span class="mw-headline" id="Internals">Internals</span></h2>
<p>The original <a href="Update_Fiji" class="mw-redirect" title="Update Fiji">Fiji Updater</a> was very limited; it only allowed to download new versions of files, and it did not have an option to determine whether a local version was previously installed via the Updater or not.
</p><p>However, it already set the scene for the current Updater, as many people happily used the old one.
</p><p>These are the building blocks of the Fiji Updater:
</p>
<h3><span class="mw-headline" id="Checksumming">Checksumming</span></h3>
<p>File versions are identified by a cryptographic hash of the file contents, and possibly the file name.
</p><p>Two different methods are applied: one for <i>.jar</i> files and one for all the other files.  For regular files, the file name (without trailing NUL nor line feed character) and the exact file contents are piped into the SHA-1 algorithm.  For <i>.jar</i> files, the file names of the <u>entries</u> and the exact contents of those files are pushed through the SHA-1 algorithm, one after another.
</p><p>The reason why <i>.jar</i> files are different is that they are really nothing more than glorified <i>.zip</i> files, and as such contain timestamps.  If those timestamps differ, the <i>.zip</i> files differ.  So if developer Anne Berlin compiles some plugin in Chicago and developer Dario Espana compiles the same plugin on Fiji, chances are that the timestamps are different, and therefore the <i>.jar</i> files, even if they contain the same <i>.class' files!</i>
</p>
<h3><span class="mw-headline" id="The_database">The database</span></h3>
<p>Originally, the database was stored in the file <i>current.txt</i>, which is stored in the <i>update/</i> directory of <a href="Fiji.sc" title="Fiji.sc">fiji.sc</a>'s web server.  Its format was simply lines in the form
</p>
<pre>&lt;filename&gt; &lt;timestamp&gt; &lt;checksum&gt;
</pre>
<p>and a file was considered updateable when its checksum disagreed with the local checksum and the timestamp of the local file was older than the timestamp in <i>current.txt</i>.
</p><p>The old updater was never meant for anything else than the Fiji launchers, <i>ij.jar</i> and <i>.jar</i> files in the directories <i>plugins/</i>, <i>misc/</i>, <i>retro/</i> and <i>jars/</i>, so it would not even pick up on the fact that it installed a, say, <i>.py</i> file, and happily offer it for update <u>again</u>.  Therefore, <i>current.txt</i> <u>must not</u> contain anything else than files matching said expectations.
</p><p>The new database is stored in the file <i>db.xml.gz</i>, which again is a static file.  But -- as the name suggests -- it obeys an extensible XML schema.
</p><p>This database not only stores the same information as <i>current.txt</i>, it can contain arbitrary file names (even including spaces, which is not possible with the former database), store descriptions of the files, have information about the platform, categories and most importantly, it has the checksums of all known previous versions so that we can finally decide whether it is safe to update files or whether they are locally modified and the user should state <b>explicitely</b> that it is safe to update.
</p>
<h2><span class="mw-headline" id="File_organization">File organization</span></h2>
<p>Different file types are stored at different locations in an ImageJ/Fiji installation, where they are picked up by the updater (see the <a rel="nofollow" class="external text" href="https://github.com/imagej/imagej-updater/blob/imagej-updater-0.8.1/src/main/java/net/imagej/updater/Checksummer.java#L439-L451">source code</a> for technical details):
</p>
<pre> jars/
 retro/
 misc/
   .jar
   .class
</pre>
<pre> plugins/ (and subfolders)
   .jar
   .class
   .txt
   .ijm
   .py
   .rb
   .clj
   .js
   .bsh
   .groovy
   .gvy
</pre>
<pre> scripts/
   .py
   .rb
   .clj
   .js
   .bsh
   .m
   .groovy
   .gvy
</pre>
<pre> macros/
   .txt
   .ijm
</pre>
<pre> luts/
   .lut
</pre>
<pre> images/
   .png
   .tif
   .txt
</pre>
<pre> Contents/
   .icns
   .plist
</pre>
<pre> lib/
 mm/
 mmautofocus/
 mmplugins/
   (all files)
</pre>
<p>The updater will only pick up files stored at the appropriate location according to their function. In addition, the <code>./lib/</code> folder contains platform-specific sub-directories to allow loading of native libraries dependent on the platform:
</p>
<pre> lib/
   linux32/
   linux64/
   macosx/
   win32/
   win64/
</pre>
<p>Further information is in this <a rel="nofollow" class="external text" href="https://groups.google.com/forum/#!topic/fiji-devel/QbY4XnLC-wE">thread on fiji-devel</a>
</p>
<h2><span class="mw-headline" id="The_actual_files">The actual files</span></h2>
<p>The files corresponding to the database entries are also stored as flat files of the form
</p>
<pre>&lt;relative path&gt;-&lt;timestamp&gt;
</pre>
<p>in the same directory as the databases.  The <i>relative path</i> refers to the path inside the Fiji directory, e.g. <i>plugins/Fiji_Updater.jar</i>.
</p>
<!-- 
NewPP limit report
Cached time: 20200713074101
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.032 seconds
Real time usage: 0.037 seconds
Preprocessor visited node count: 115/1000000
Preprocessor generated node count: 813/1000000
Post‐expand include size: 1463/2097152 bytes
Template argument size: 370/2097152 bytes
Highest expansion depth: 6/40
Expensive parser function count: 0/3
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    8.076      1 - -total
 60.33%    4.872      1 - Template:Outdated
 46.64%    3.767      1 - Template:Warning
 38.41%    3.102      1 - Template:Bc
 36.16%    2.920      1 - Template:Ambox
 11.88%    0.959      1 - Template:Arrow
-->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="index.php?title=Uploading_plugins&amp;oldid=22727">http://imagej.net/index.php?title=Uploading_plugins&amp;oldid=22727</a>"</div>
							</div>

			<div id="footer">
				<p> This page was last modified on 6 September 2016, at 22:45.</p><ul><li><a href="./ImageJ:Privacy_policy" title="ImageJ:Privacy policy">Privacy policy</a></li><li><a href="./ImageJ:About" class="mw-redirect" title="ImageJ:About">About ImageJ</a></li><li><a href="Imprint" title="Imprint">Imprint</a></li></ul>			</div>

			<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="./Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="./Category:Outdated" title="Category:Outdated">Outdated</a></li><li><a href="./Category:Development" title="Category:Development">Development</a></li></ul></div></div>		</div>

		<div id="bottom-wrap">
			<div id="footer-wrap-inner">
				<div id="ternary" class="footer">
					<ul>
						<li class="widget">
							<img id="logo" src="skins/imagej-128.png" alt="">
						</li>
					</ul>
				</div>
			</div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.load(["ext.fancytree","ext.suckerfish","mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.SimpleTooltip"]);});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":186});});</script>
		</body>
		</html>
		