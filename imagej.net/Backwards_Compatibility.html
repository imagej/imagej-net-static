<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Compatibility - ImageJ</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Compatibility","wgTitle":"Compatibility","wgCurRevisionId":32256,"wgRevisionId":32256,"wgArticleId":2559,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Compatibility","wgRelevantArticleId":2559,"wgRequestId":"9d619cfbe89f91a9fc9b6820","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgPreferredVariant":"en","fancytree_path":"/extensions/TreeAndMenu/fancytree"});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user.cssprefs":"ready","user":"ready","user.options":"loading","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","skins.erudite":"ready"});mw.loader.implement("user.options@0j3lz3q",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens@1ku9xth",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.page.startup"]);});</script>
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%252Cshared%257Cmediawiki.sectionAnchor%257Cskins.erudite&amp;only=styles&amp;skin=erudite.css"/>
<script async="" src="load.php%3Fdebug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=erudite"></script>
<link rel="stylesheet" href="extensions/TreeAndMenu/fancytree/fancytree.css"/><link rel="stylesheet" href="extensions/TreeAndMenu/suckerfish/suckerfish.css"/>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=erudite.css"/>
<meta name="generator" content="MediaWiki 1.28.0"/>
<meta name="description" content="Backward compatibility is one of ImageJ's most important goals. It must remain possible to use existing plugins and macros with new versions of ImageJ."/>
<link rel="shortcut icon" href="skins/ij2.ico"/>

<script type="text/javascript" src="extensions/SyntaxHighlighter/syntaxhighlighter/scripts/shCore.js"></script>
<script type="text/javascript" src="extensions/SyntaxHighlighter/syntaxhighlighter/scripts/shBrushJava.js"></script>
<script type="text/javascript">
SyntaxHighlighter.all();
</script>
<link rel="stylesheet" type="text/css" media="screen" href="extensions/SyntaxHighlighter/syntaxhighlighter/styles/shCoreMinit.css" />

	<meta property="og:type" content="article"/>

	<meta property="og:site_name" content="ImageJ"/>

	<meta property="og:title" content="Compatibility"/>

	<meta property="og:description" content="Backward compatibility is one of ImageJ's most important goals. It must remain possible to use existing plugins and macros with new versions of ImageJ."/>


<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Compatibility rootpage-Compatibility skin-erudite action-view">
		<div class="mw-jump">
			<a href="Backwards_Compatibility.html#bodyContent">Skip to content</a>, 			<a href="Backwards_Compatibility.html#search">Skip to search</a>
		</div>

		<div id="top-wrap" role="banner">
			<h1><a href="Welcome" title="ImageJ" rel="home">ImageJ</a></h1>
			<div id="tagline">From ImageJ</div>

			<a id="menubutton" href="Backwards_Compatibility.html#menu">Menu</a>
			<div id="nav" role="navigation">
			<ul id='menu'>
<li id="menu-item-n-About"><a href="ImageJ">About</a></li>
<li id="menu-item-n-Downloads"><a href="Downloads">Downloads</a></li>
<li id="menu-item-n-Learn"><a href="Learn">Learn</a></li>
<li id="menu-item-n-Develop"><a href="Development">Develop</a></li>
<li id="menu-item-n-News"><a href="News">News</a></li>
<li id="menu-item-n-Events"><a href="Events">Events</a></li>
<li id="menu-item-n-Help"><a href="Help">Help</a></li>
</ul>
			</div>
		</div>

		<div id="mw-js-message"></div>
		
		<div id="main" role="main">
			<div id="nav-meta">
			<span id="ca-nstab-main" class="selected"><a href="Backwards_Compatibility.html" title="View the content page [c]" accesskey="c">Page</a></span><span class="meta-sep">|</span><span id="ca-talk" class="new"><a href="index.php?title=Talk:Compatibility&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></span><span class="meta-sep">|</span><span id="ca-viewsource"><a href="index.php?title=Compatibility&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span><span class="meta-sep">|</span><span id="ca-history"><a href="index.php?title=Compatibility&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></span><span class="meta-sep">|</span>			</div>

			<div id="bodyContent">
				<h1>Compatibility</h1>
				
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><table class="infobox" cellspacing="5" style="max-width: 30em; font-size: 80%; text-align: left; float: right; border: 1px solid #a0a0a0;">
<tr>
<th colspan="2" style="text-align: center; font-size: 130%;"> <div style="float: left"></div>ImageJ Legacy Bridge<div style="clear: left;"></div>
</th></tr>
<tr>
<th> Project
</th>
<td> ImageJ
</td></tr>
<tr>
<th> URL
</th>
<td> <a rel="nofollow" class="external free" href="ImageJ_Legacy">https://imagej.net/ImageJ_Legacy</a>
</td></tr>
<tr>
<th> Source
</th>
<td> <a rel="nofollow" class="external text" href="https://github.com/imagej/imagej-legacy/releases/tag/imagej-legacy-0.25.0">on GitHub</a>
</td></tr>
<tr>
<th> License
</th>
<td> <a href="BSD-2" class="mw-redirect" title="BSD-2">BSD-2</a>
</td></tr>
<tr>
<th> Release
</th>
<td> <a rel="nofollow" class="external text" href="http://maven.imagej.net/index.html#nexus-search;gav~net.imagej~imagej-legacy~0.25.0~~~kw,versionexpand">0.25.0</a>
</td></tr>
<tr>
<th> Date
</th>
<td> Thu May 25 12:47:55 CDT 2017
</td></tr>
<tr>
<th> <a href="Development_status" class="mw-redirect" title="Development status">Development status</a>
</th>
<td> Active
</td></tr>
<tr>
<th> <a href="Support_status" class="mw-redirect" title="Support status">Support status</a>
</th>
<td> Active
</td></tr>
<tr>
<th colspan="2" style="background: lightgray; font-variant: small-caps; text-align: center"> <a href="Team" class="mw-redirect" title="Team">Team</a>
</th></tr>
<tr>
<th> <a href="Team" class="mw-redirect" title="Team">Founders</a>
</th>
<td> <a href="./User:Rueden" title="User:Rueden">Curtis Rueden</a>, <a href="./User:Schindelin" title="User:Schindelin">Johannes Schindelin</a>
</td></tr>
<tr>
<th> <a href="Team" class="mw-redirect" title="Team">Leads</a>
</th>
<td> <a href="./User:Rueden" title="User:Rueden">Curtis Rueden</a>
</td></tr>
<tr>
<th> <a href="Team" class="mw-redirect" title="Team">Developers</a>
</th>
<td> <a href="./User:Rueden" title="User:Rueden">Curtis Rueden</a>
</td></tr>
<tr>
<th> <a href="Team" class="mw-redirect" title="Team">Debuggers</a>
</th>
<td> <a href="./User:Rueden" title="User:Rueden">Curtis Rueden</a>
</td></tr>
<tr>
<th> <a href="Team" class="mw-redirect" title="Team">Reviewers</a>
</th>
<td> <a href="./User:Rueden" title="User:Rueden">Curtis Rueden</a>
</td></tr>
<tr>
<th> <a href="Team" class="mw-redirect" title="Team">Support</a>
</th>
<td> <a href="./User:Rueden" title="User:Rueden">Curtis Rueden</a>
</td></tr>
<tr>
<th> <a href="Team" class="mw-redirect" title="Team">Maintainers</a>
</th>
<td> <a href="./User:Rueden" title="User:Rueden">Curtis Rueden</a>
</td></tr>

<tr>
<th> <a href="Team" class="mw-redirect" title="Team">Contributors</a>
</th>
<td> <a href="./User:Schindelin" title="User:Schindelin">Johannes Schindelin</a>, <a href="./User:Bdezonia" title="User:Bdezonia">Barry DeZonia</a>, <a href="./User:Leek" title="User:Leek">Lee Kamentsky</a>, <a href="./User:Eglinger" title="User:Eglinger">Jan Eglinger</a>, <a href="./User:Tiago" title="User:Tiago">Tiago Ferreira</a>, <a href="./User:Grislis" title="User:Grislis">Aivar Grislis</a>, <a href="./User:Harris" title="User:Harris">Grant Harris</a>, <a href="./User:Hinerm" title="User:Hinerm">Mark Hiner</a>, <a href="./User:Jug" title="User:Jug">Florian Jug</a>, <a href="./User:Lentz" title="User:Lentz">Rick Lentz</a>, <a href="./User:Bnanes" title="User:Bnanes">Benjamin Nanes</a>, <a href="./User:Bnorthan" title="User:Bnorthan">Brian Northan</a>
</td></tr>
</table><div class="project-info">
<span class="project-logo"><a href="ImageJ" title="ImageJ"><img class="simple-tooltip simple-tooltip-img" data-simple-tooltip="This page describes content which is part of the core ImageJ distribution. Click the logo for details." src="_images/d/d1/Imagej2-icon.png"></img></a></span></div>
<p>Backward compatibility is one of ImageJ's most important goals. It must remain possible to use existing plugins and macros with new versions of <a href="ImageJ" title="ImageJ">ImageJ</a>.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Backwards_Compatibility.html#ImageJ_Legacy"><span class="tocnumber">1</span> <span class="toctext">ImageJ Legacy</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="Backwards_Compatibility.html#The_ImageJ_legacy_UI"><span class="tocnumber">1.1</span> <span class="toctext">The ImageJ legacy UI</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="Backwards_Compatibility.html#Translation_of_data_structures"><span class="tocnumber">1.2</span> <span class="toctext">Translation of data structures</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="Backwards_Compatibility.html#Updating_ImageJ_commands_to_the_new_paradigm"><span class="tocnumber">2</span> <span class="toctext">Updating ImageJ commands to the new paradigm</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="Backwards_Compatibility.html#See_also"><span class="tocnumber">3</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="ImageJ_Legacy">ImageJ Legacy</span></h2>
<p>The <a href="ImageJ2" title="ImageJ2">ImageJ2</a> project is a complete redesign of ImageJ, with no dependency on <a href="ImageJ_1.x" class="mw-redirect" title="ImageJ 1.x">ImageJ 1.x</a>. However, to facilitate backwards compatibility, there is an <b>ImageJ Legacy</b> component (source <a rel="nofollow" class="external text" href="https://github.com/imagej/imagej-legacy/">on GitHub</a>) which provides extensions for ImageJ2 and ImageJ1 to operate in harmony.
</p><p>The ImageJ legacy layer provides the following extensions:
</p>
<ul><li> It makes ImageJ 1.x <b>usable <a href="Headless" title="Headless">headless</a></b> from the command line.</li>
<li> It wraps the <b>ImageJ 1.x UI as a <a href="SciJava" title="SciJava">SciJava</a> user interface</b>.</li>
<li> It <b>translates between ImageJ1 and ImageJ2 data structures</b> on demand.</li></ul>
<p>ImageJ2 currently uses the ImageJ 1.x user interface by default, since many users need to retain access to ImageJ1 plugins.
</p>
<h3><span class="mw-headline" id="The_ImageJ_legacy_UI">The ImageJ legacy UI</span></h3>
<p>The legacy layer converts ImageJ1 into a SciJava-compatible user interface by implementing the <a rel="nofollow" class="external text" href="https://javadoc.scijava.org/SciJava/org/scijava/ui/UserInterface.html">UserInterface</a> interface via the <a rel="nofollow" class="external text" href="https://javadoc.scijava.org/ImageJ/net/imagej/legacy/ui/LegacyUI.html">LegacyUI</a> class.
</p><p>However, things are complicated by the fact that ImageJ1 was not designed with such requirements in mind. The legacy layer uses a bytecode manipulation library called <a href="Javassist" title="Javassist">Javassist</a> to rewrite portions of ImageJ1 at runtime, in order to facilitate integration and extension. See the <a rel="nofollow" class="external text" href="https://github.com/imagej/ij1-patcher/">ij1-patcher</a> project for details.
</p>
<h3><span class="mw-headline" id="Translation_of_data_structures">Translation of data structures</span></h3>
<p>Each <a rel="nofollow" class="external text" href="https://javadoc.scijava.org/ImageJ/net/imagej/display/ImageDisplay.html">ImageDisplay</a> has a linked <a rel="nofollow" class="external text" href="https://javadoc.scijava.org/ImageJ1/ij/ImagePlus.html">ImagePlus</a>, kept in sync by the <a rel="nofollow" class="external text" href="https://javadoc.scijava.org/ImageJ/net/imagej/legacy/LegacyImageMap.html">LegacyImageMap</a>. Whenever the need arises, the legacy layer syncs the linked data objects. In order to maintain reasonable performance, every opportunity is taken to avoid data translation by making data changes in place, and only on demand (lazily, with caching). The legacy layer reuses data by reference when feasible—in particular, when image planes are stored in primitive arrays—but in some cases the data must be copied (e.g., for ROIs).
</p><p>Currently, automatic synchronization is disabled as it has negative performance implications. The planned solution to the performance problems is to <a rel="nofollow" class="external text" href="https://github.com/imagej/imagej-legacy/issues/86">implement a wrapping layer</a>, instead of relying on up-front pixel-wise translation.
</p><p>In the mean time, full synchronization can be forced by setting a <code>imagej.legacy.sync</code> <a rel="nofollow" class="external text" href="https://docs.oracle.com/javase/tutorial/essential/environment/sysprop.html">system property</a>. This can be done in a running ImageJ instance, for example by running the following as a <a href="BeanShell_Scripting" title="BeanShell Scripting">BeanShell script</a>:
</p>
<pre class="brush:java">
System.setProperty("imagej.legacy.sync", "true");
</pre>
<h2><span class="mw-headline" id="Updating_ImageJ_commands_to_the_new_paradigm">Updating ImageJ commands to the new paradigm</span></h2>
<p>The eventual goal is to migrate all core ImageJ1 plugins to the ImageJ2 paradigm. Many ImageJ1 plugins have been already been updated in this fashion; see the <a rel="nofollow" class="external text" href="https://github.com/imagej/imagej-ops/">imagej-ops</a> and  <a rel="nofollow" class="external text" href="https://github.com/imagej/imagej-plugins-commands/">imagej-plugins-commands</a> repositories in particular.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li> The <a rel="nofollow" class="external text" href="http://conference.imagej.net/2010/curtis-rueden/2010-10-27-ImageJDev.pdf">ImageJDev talk</a> from the ImageJ 2010 Conference, for a historical perspective on how this approach to compatibility evolved over time.</li></ul>

<!-- 
NewPP limit report
Cached time: 20200713064552
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.144 seconds
Real time usage: 0.147 seconds
Preprocessor visited node count: 4893/1000000
Preprocessor generated node count: 5354/1000000
Post‐expand include size: 7601/2097152 bytes
Template argument size: 2474/2097152 bytes
Highest expansion depth: 12/40
Expensive parser function count: 0/3
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%  134.595      1 - -total
 94.39%  127.046      1 - Template:ComponentStats:net.imagej:imagej-legacy
 93.53%  125.892      1 - Template:Component
 80.66%  108.564     19 - Template:Person
  3.53%    4.750      6 - Template:GitHub
  2.65%    3.564      5 - Template:Javadoc
  1.04%    1.403      1 - Template:Project
  0.90%    1.218      1 - Template:Maven
  0.81%    1.090      1 - Template:DevStatus
  0.78%    1.045      1 - Template:SupportStatus
-->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="index.php?title=Compatibility&amp;oldid=32256">http://imagej.net/index.php?title=Compatibility&amp;oldid=32256</a>"</div>
							</div>

			<div id="footer">
				<p> This page was last modified on 2 June 2017, at 21:04.</p><ul><li><a href="./ImageJ:Privacy_policy" title="ImageJ:Privacy policy">Privacy policy</a></li><li><a href="./ImageJ:About" class="mw-redirect" title="ImageJ:About">About ImageJ</a></li><li><a href="Imprint" title="Imprint">Imprint</a></li></ul>			</div>

			<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>		</div>

		<div id="bottom-wrap">
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.load(["ext.fancytree","ext.suckerfish","mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.SimpleTooltip"]);});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":298});});</script>
		</body>
		</html>
		