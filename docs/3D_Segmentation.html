<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>3D Segmentation - ImageJ</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"3D_Segmentation","wgTitle":"3D Segmentation","wgCurRevisionId":45240,"wgRevisionId":45240,"wgArticleId":12630,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"3D_Segmentation","wgRelevantArticleId":12630,"wgRequestId":"95750dd4ee583f7742313668","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgPreferredVariant":"en","fancytree_path":"/extensions/TreeAndMenu/fancytree"});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user.cssprefs":"ready","user":"ready","user.options":"loading","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","skins.erudite":"ready"});mw.loader.implement("user.options@0j3lz3q",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens@1ku9xth",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.page.startup"]);});</script>
<link rel="stylesheet" href="erudite14.css"/>
<link rel="stylesheet" href="extensions/TreeAndMenu/fancytree/fancytree.css"/><link rel="stylesheet" href="extensions/TreeAndMenu/suckerfish/suckerfish.css"/>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="erudite15.css"/>
<meta name="generator" content="MediaWiki 1.28.0"/>
<meta name="description" content="This plugin implements various algorithms to segment 3D images, as part of the 3D ImageJ Suite."/>
<link rel="shortcut icon" href="skins/ij2.ico"/>
	<meta property="og:type" content="article"/>

	<meta property="og:site_name" content="ImageJ"/>

	<meta property="og:title" content="3D Segmentation"/>

	<meta property="og:description" content="This plugin implements various algorithms to segment 3D images, as part of the 3D ImageJ Suite."/>


<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-3D_Segmentation rootpage-3D_Segmentation skin-erudite action-view">
		<div id="top-wrap" role="banner">
			<h1><a href="Welcome" title="ImageJ" rel="home">ImageJ</a></h1>
			<div id="tagline">From ImageJ</div>

			<a id="menubutton" href="3D_Segmentation.html#menu">Menu</a>
			<div id="nav" role="navigation">
			<ul id='menu'>
<li id="menu-item-n-About"><a href="ImageJ">About</a></li>
<li id="menu-item-n-Downloads"><a href="Downloads">Downloads</a></li>
<li id="menu-item-n-Learn"><a href="Learn">Learn</a></li>
<li id="menu-item-n-Develop"><a href="Development">Develop</a></li>
<li id="menu-item-n-News"><a href="News">News</a></li>
<li id="menu-item-n-Events"><a href="Events">Events</a></li>
<li id="menu-item-n-Help"><a href="Help">Help</a></li>
</ul>
			</div>
		</div>

		<div id="mw-js-message"></div>
		
		<div id="main" role="main">

			<div id="bodyContent">
				<div style="font-size: large; border: 1px solid black; padding: 1em; margin-bottom: 1em; text-align: center; background-color: #fda;">
					This is an archive of the old MediaWiki-based ImageJ wiki. The current website can be found at <a href="https://imagej.net/">imagej.net</a>.
				</div>

				<h1>3D Segmentation</h1>
				
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="3D_Segmentation.html#3D_Segmentation"><span class="tocnumber">1</span> <span class="toctext">3D Segmentation</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="3D_Segmentation.html#Author"><span class="tocnumber">2</span> <span class="toctext">Author</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="3D_Segmentation.html#Features"><span class="tocnumber">3</span> <span class="toctext">Features</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="3D_Segmentation.html#3D_Iterative_Thresholding"><span class="tocnumber">4</span> <span class="toctext">3D Iterative Thresholding</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="3D_Segmentation.html#3D_Spot_Segmentation"><span class="tocnumber">5</span> <span class="toctext">3D Spot Segmentation</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="3D_Segmentation.html#3D_Watershed"><span class="tocnumber">6</span> <span class="toctext">3D Watershed</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="3D_Segmentation.html#Download"><span class="tocnumber">7</span> <span class="toctext">Download</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="3D_Segmentation.html#Citation"><span class="tocnumber">8</span> <span class="toctext">Citation</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="3D_Segmentation.html#License"><span class="tocnumber">9</span> <span class="toctext">License</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="3D_Segmentation.html#Changelog"><span class="tocnumber">10</span> <span class="toctext">Changelog</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="3D_Segmentation">3D Segmentation</span></h2>
<p>This plugin implements various algorithms to segment 3D images, as part of the <a href="3D_ImageJ_Suite" title="3D ImageJ Suite">3D ImageJ Suite</a>.
</p>
<h2><span class="mw-headline" id="Author">Author</span></h2>
<p><a href="./User:Tboudier" title="User:Tboudier">Thomas Boudier</a>
</p>
<h2><span class="mw-headline" id="Features">Features</span></h2>
<p>Several algorithms for segmentation are proposed&#160;:
</p>
<ul><li> 3D <b>hysteresis thresholding</b> with two thresholds (see <a rel="nofollow" class="external text" href="https://imagejdocu.list.lu/plugin/segmentation/hysteresis_thresholding/start">2D hysteresis</a> for explanation).</li>
<li> 3D <b>simple segmentation</b> with thresholding to label 3D objects (similar to <a rel="nofollow" class="external text" href="https://imagejdocu.list.lu/plugin/analysis/3d_object_counter/start">3D object counter</a>).</li>
<li> 3D <b>iterative thresholding</b> (find optimal threshold for each object).</li>
<li> 3D <b>spot segmentation</b> with various local threshold estimations.</li>
<li> 3D <b>Maxima Finder</b> (with noise parameter)</li>
<li> 3D seeds-based <b>watershed</b> with automatic local maxima detection for seeds.</li></ul>
<h2><span class="mw-headline" id="3D_Iterative_Thresholding">3D Iterative Thresholding</span></h2>
<p>The plugin will basically <b>test all thresholds</b> and detect objects for all thresholds, it will then try to build a <i>lineage</i> of the objects detected, linking them from one  threshold to the next threshold, taking possible splits into account. So <b>different objects</b> can be segmented with <b>different thresholds</b>, the plugin allows various criteria to pick the best threshold&#160;:
</p>
<ul><li> <b>Elongation</b>&#160;: the threshold leading to the most round object is chosen (minimal elongation).</li>
<li> <b>Volume</b>&#160;: the threshold leading to the largest object.</li>
<li> <b>MSER</b>&#160;: the threshold where the volume of the object is most stable (minimal variation).</li>
<li> <b>Edges</b>&#160;: the threshold where the objects has maximal edges (see <a rel="nofollow" class="external text" href="https://imagejdocu.list.lu/plugin/filter/3d_edge_and_symmetry_filter/start">edge plugin</a>) </li></ul>
<p>The other parameters are related to the <b>minimal and maximal volumes</b> of the objects. The <i>thresholds tested</i> can be tuned with 3 options with the <i>value</i> parameter&#160;: 
</p>
<ul><li> <b>Step</b>&#160;: threshold are tested each step <i>value</i> </li>
<li> <b>Kmeans</b>&#160;: histogram is analysed and clustered into <i>value</i> classes using a KMeans algorithm.</li>
<li> <b>Volume</b>&#160;: a constant number of pixels between two thresholds using <i>value</i> thresholds. </li></ul>
<p>For <b>8-bits</b> images it is recommended to use the method <i>Step</i> with <i>value</i> between 1 and 5. For <b>16-bits</b> images try <i>Step</i> with values between 5 and 100 depending on the dynamic of your data. Note that the more threshold tested the more memory used. In order not to test low thresholds you can specify to start with the <b>mean value</b> of the image as the lowest threshold or specify manually the lowest threshold to start with. The image can be **filtered** before thresholding with a 3D median filter with radii proportional to the minimal volume. The <b>contrast</b> refers to the range of thresholds where the object exists, noise or very faint objects may have very low contrast as opposed to very contrasted object. 
</p>
<div class="MediaTransformError" style="width: 1058px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div>
<p>Iterative thresholding using different criteria, bottom left elongation, top right volume and bottom right MSER.
</p><p>Testing all thresholds may lead to <b>objects being divided into smaller objects</b> for high thresholds. For instance <b>touching cells</b> may result in close nuclei, at low contrast and low threshold the two nuclei may seem like touching and form only one object, however at high threshold and contrast two separate objects are  being seen. 
</p>
<div class="MediaTransformError" style="width: 365px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div>
<p>Dividing objects with thresholds, top left raw image with high brightness, top right raw image with adjusted contrast to distinguish the dividing nuclei, bottom left first channel of Iterative thresholding showing brighter and smaller objects, bottom right second channel of Iterative thresholding showing merged nuclei for lower threshold.
</p><p>If you find this plugin useful for your work, please cite this paper and refer to  <a href="3D_ImageJ_Suite" title="3D ImageJ Suite">3D ImageJ Suite</a> and this article&#160;: <a rel="nofollow" class="external text" href="http://www.biomedcentral.com/1471-2105/15/9">A generic classification-based method for segmentation of nuclei in 3D images of early embryos</a>
</p>
<h2><span class="mw-headline" id="3D_Spot_Segmentation">3D Spot Segmentation</span></h2>
<p>The plugin works with two images, one containing the <b>seeds</b> of the objects, that can be obtained from local maxima (see <a href="3D_Filters" title="3D Filters">3D Filters</a>), the other image containing signal data. The program computes a <b>local threshold</b> around each seeds and cluster voxels with values higher than the local threshold computed. Spots-like objects can be enhanced using a topHat (see <a href="3D_Filters" title="3D Filters">3D Filters</a>) or a <a href="Edge_and_symmetry_filter" title="Edge and symmetry filter">Edge and symmetry filter </a>. A plugin <a rel="nofollow" class="external text" href="https://imagejdocu.list.lu/tutorial/plugins/3d_maxima_finder">3D maxima Finder</a> is also available to compute these local maxima, similarly to the find maxima in ImageJ/Fiji. 
</p><p>Three methods are available for computing the value of the local threshold and 3 methods for clustering are also proposed. The option <b>watershed</b> can be chosen to avoid merging of close spots. 
</p><p>A tutorial is also available&#160;:  <a href="_images/0/02/3d_seg_spot_tutorial.pdf" class="internal" title="3d seg spot tutorial.pdf">Media:3d seg spot tutorial.pdf</a>
</p>
<div class="MediaTransformError" style="width: 266px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div> <div class="MediaTransformError" style="width: 266px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div><div class="MediaTransformError" style="width: 266px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div>
<p>Left, slice of a 3D raw image with crowded objects with different intensities. Middle, the zones around each detected local maxima, computed using watershed. Right, the final segmentation of the objects.
</p>
<h2><span class="mw-headline" id="3D_Watershed">3D Watershed</span></h2>
<p>The plugin works with two images, one containing the <b>seeds</b> of the objects, that can be obtained from local maxima (see <a href="3D_Filters" title="3D Filters">3D Filters</a>), the other image containing signal data. A first <i>threshold1</i> is used for seeds (only seeds with <i>value &gt; threshold1</i> will be used). A second threshold is used to cluster voxels with <i>values &gt; threshold2</i> In this implementation voxels are clustered to the seeds in descending order of voxel values. 
An alternative implementation is available in <a rel="nofollow" class="external text" href="http://fiji.sc/Classic_Watershed">Fiji classic watershed</a>.
</p><p>Two plugins <b>3D splitting</b> and <b>3D Voronoi</b> are also available, more details in this brief <a rel="nofollow" class="external text" href="https://imagejdocu.list.lu/tutorial/general/watershed_3d">tutorial</a>.
</p>
<h2><span class="mw-headline" id="Download">Download</span></h2>
<p>For details go to the <a href="3D_ImageJ_Suite" title="3D ImageJ Suite">3D ImageJ Suite</a>.
</p>
<h2><span class="mw-headline" id="Citation">Citation</span></h2>
<p>When using the <i>3D Segmentation</i> plugins for publication, please cite&#160;:
</p><p>J. Ollion, J. Cochennec, F. Loll, C. Escudé, T. Boudier. (<b>2013</b>) TANGO: A Generic Tool for High-throughput 3D Image Analysis for Studying Nuclear Organization. <i>Bioinformatics</i> 2013 Jul 15;29(14):1840-1. <a rel="nofollow" class="external text" href="http://dx.doi.org/10.1093/bioinformatics/btt276">doi</a>
</p>
<h2><span class="mw-headline" id="License">License</span></h2>
<p>GPL distribution (see <a rel="nofollow" class="external text" href="http://www.cecill.info/index.en.html">license</a>). Sources  are available freely.
</p>
<h2><span class="mw-headline" id="Changelog">Changelog</span></h2>
<ul><li> 22/08/2016 V3.83: watershed improved.</li>
<li> 20/08/2015 V3.4&#160;: redesigned Watershed, record Iterative Thresholding.</li>
<li> 25/05/2015 V3.2&#160;: improved watershed (especially for flat regions).</li>
<li> 21/03/2014 V2.71: bug fix in Segment3D.</li>
<li> 24/10/2013 V2.7&#160;: new Iterative Thresholding; 32-bits segmentation and labelling for large number of objects (&gt;65 535).</li></ul>

<!-- 
NewPP limit report
Cached time: 20200713064430
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.040 seconds
Real time usage: 0.039 seconds
Preprocessor visited node count: 178/1000000
Preprocessor generated node count: 3065/1000000
Post‐expand include size: 64/2097152 bytes
Template argument size: 16/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/3
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    9.893      1 - Template:Person
100.00%    9.893      1 - -total
-->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="index.php?title=3D_Segmentation&amp;oldid=45240">http://imagej.net/index.php?title=3D_Segmentation&amp;oldid=45240</a>"</div>
							</div>

			<div id="footer">
				<p> This page was last modified on 27 April 2020, at 04:00.</p><ul><li><a href="./ImageJ:Privacy_policy" title="ImageJ:Privacy policy">Privacy policy</a></li><li><a href="./ImageJ:About" class="mw-redirect" title="ImageJ:About">About ImageJ</a></li><li><a href="Imprint" title="Imprint">Imprint</a></li></ul>			</div>

			<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>		</div>

		<div id="bottom-wrap">
			<div id="footer-wrap-inner">
				<div id="ternary" class="footer">
					<ul>
						<li class="widget">
							<img id="logo" src="skins/imagej-128.png" alt="">
						</li>
					</ul>
				</div>
			</div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.load(["ext.fancytree","ext.suckerfish","mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.SimpleTooltip"]);});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":238});});</script>
		</body>
		</html>
		